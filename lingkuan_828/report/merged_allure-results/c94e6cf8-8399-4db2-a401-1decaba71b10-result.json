{"name": "数据库校验-云跟单账号策略平仓-修改币种p", "status": "failed", "statusDetails": {"message": "AssertionError: 修改币种下单总手数应该是0.02或者0.03，如果币种不在交易时间就是1，实际是：21.0\nassert (False or False or False)\n +  where False = <built-in function isclose>(21.0, 0.02, rel_tol=1e-09)\n +    where <built-in function isclose> = math.isclose\n +  and   False = <built-in function isclose>(21.0, 0.03, rel_tol=1e-09)\n +    where <built-in function isclose> = math.isclose\n +  and   False = <built-in function isclose>(21.0, 1.0, rel_tol=1e-09)\n +    where <built-in function isclose> = math.isclose", "trace": "self = <lingkuan_828.test_cloudTrader.test_cloudtrader_money_scene.Testcloudtrader_moneyandscene.Testcloudtrader_money object at 0x0000012EF6132D90>\nvar_manager = <lingkuan_828.commons.variable_manager.VariableManager object at 0x0000012EF7623640>\ndb_transaction = <pymysql.connections.Connection object at 0x0000012EF79E0F10>\n\n    @allure.title(\"数据库校验-云跟单账号策略平仓-修改币种p\")\n    def test_dbclose_cfdp(self, var_manager, db_transaction):\n        with allure.step(\"1. 获取订单详情表账号数据\"):\n            cloudTrader_user_accounts_9 = var_manager.get_variable(\"cloudTrader_user_accounts_9\")\n            sql = f\"\"\"\n                    SELECT\n                        fod.size,\n                        fod.close_no,\n                        fod.symbol,\n                        fod.order_no,\n                        foi.true_total_lots,\n                        foi.order_no,\n                        foi.operation_type,\n                        foi.create_time,\n                        foi.status\n                    FROM\n                        follow_order_detail fod\n                    INNER JOIN\n                        follow_order_instruct foi\n                    ON\n                        foi.order_no = fod.close_no COLLATE utf8mb4_0900_ai_ci\n                    WHERE foi.operation_type=%s\n                        AND fod.account = %s\n                        \"\"\"\n            params = (\n                '1',\n                cloudTrader_user_accounts_9,\n            )\n    \n            # 调用轮询等待方法（带时间范围过滤）\n            db_data = self.query_database_with_time(\n                db_transaction=db_transaction,\n                sql=sql,\n                params=params,\n                time_field=\"foi.create_time\"\n            )\n    \n        with allure.step(\"2. 校验数据\"):\n            if not db_data:\n                pytest.fail(\"数据库查询结果为空，无法提取数据\")\n    \n            addsalve_size_cfdp_close = [record[\"size\"] for record in db_data]\n            var_manager.set_runtime_variable(\"addsalve_size_cfdp_close\", addsalve_size_cfdp_close)\n            addsalve_size_cfdp_total = sum(addsalve_size_cfdp_close)\n>           assert (math.isclose(addsalve_size_cfdp_total, 0.02, rel_tol=1e-9) or\n                    math.isclose(addsalve_size_cfdp_total, 0.03, rel_tol=1e-9) or\n                    math.isclose(addsalve_size_cfdp_total, 1.0,\n                                 rel_tol=1e-9)), f\"修改币种下单总手数应该是0.02或者0.03，如果币种不在交易时间就是1，实际是：{addsalve_size_cfdp_total}\"\nE           AssertionError: 修改币种下单总手数应该是0.02或者0.03，如果币种不在交易时间就是1，实际是：21.0\nE           assert (False or False or False)\nE            +  where False = <built-in function isclose>(21.0, 0.02, rel_tol=1e-09)\nE            +    where <built-in function isclose> = math.isclose\nE            +  and   False = <built-in function isclose>(21.0, 0.03, rel_tol=1e-09)\nE            +    where <built-in function isclose> = math.isclose\nE            +  and   False = <built-in function isclose>(21.0, 1.0, rel_tol=1e-09)\nE            +    where <built-in function isclose> = math.isclose\n\ntest_cloudTrader\\test_cloudtrader_money_scene.py:458: AssertionError"}, "description": "\n    ### 用例说明\n    - 前置条件：有云策略和云跟单\n    - 操作步骤：\n      1. 有三个账号，分别修改三个账号的后缀.@ .p .min\n      2. 进行开仓\n      3. 判断三个账号的币种手数是否正确\n      4. 进行平仓\n      5. 判断三个账号的币种手数是否正确\n    - 预期结果：三个账号的币种手数正确\n    ", "steps": [{"name": "1. 获取订单详情表账号数据", "status": "passed", "steps": [{"name": "轮询等待数据稳定（超时: 30秒，稳定期: 2秒）", "status": "passed", "steps": [{"name": "执行单次数据库查询", "status": "passed", "steps": [{"name": "执行数据库查询", "status": "passed", "attachments": [{"name": "执行SQL", "source": "0f8f6f8d-9a65-4da3-83d2-d0bbfe16e508-attachment.txt", "type": "text/plain"}, {"name": "SQL参数", "source": "097fe539-1cb0-48bb-80a3-948d5f57caa5-attachment.txt", "type": "text/plain"}], "start": 1756432770308, "stop": 1756432771346}], "attachments": [{"name": "查询条件", "source": "88e47d01-86be-4db8-8299-7ad97de366a9-attachment.txt", "type": "text/plain"}], "start": 1756432770308, "stop": 1756432771346}, {"name": "轮询中（已等待1.1秒）", "status": "passed", "attachments": [{"name": "当前状态", "source": "89f4e8d7-52ed-4a34-8072-891ad79833b3-attachment.txt", "type": "text/plain"}, {"name": "超时倒计时", "source": "678b1a04-aa65-4653-b611-1b45c2ed579d-attachment.txt", "type": "text/plain"}], "start": 1756432771346, "stop": 1756432771348}, {"name": "判断结果稳定性", "status": "passed", "attachments": [{"name": "判断结果", "source": "c4021d73-e40c-401e-acc1-9a44185a09cf-attachment.txt", "type": "text/plain"}], "start": 1756432771348, "stop": 1756432771349}, {"name": "数据发生变化", "status": "passed", "attachments": [{"name": "状态说明", "source": "6e303d12-405a-4571-905c-d01d6d68e4cc-attachment.txt", "type": "text/plain"}], "start": 1756432771349, "stop": 1756432771350}, {"name": "执行单次数据库查询", "status": "passed", "steps": [{"name": "执行数据库查询", "status": "passed", "attachments": [{"name": "执行SQL", "source": "29527647-37f0-404d-8b26-f5ff01129349-attachment.txt", "type": "text/plain"}, {"name": "SQL参数", "source": "4edd362e-f120-4a5b-afc7-6362b89ad76e-attachment.txt", "type": "text/plain"}], "start": 1756432773405, "stop": 1756432774381}], "attachments": [{"name": "查询条件", "source": "eb9b7d4a-d917-4719-93ed-962f1c3a419d-attachment.txt", "type": "text/plain"}], "start": 1756432773404, "stop": 1756432774381}, {"name": "轮询中（已等待4.1秒）", "status": "passed", "attachments": [{"name": "当前状态", "source": "a65596bc-f14b-4878-807e-389e05d8d148-attachment.txt", "type": "text/plain"}, {"name": "超时倒计时", "source": "c8b0873c-f007-4b56-a7b1-cdef22d7f12f-attachment.txt", "type": "text/plain"}], "start": 1756432774381, "stop": 1756432774382}, {"name": "判断结果稳定性", "status": "passed", "attachments": [{"name": "判断结果", "source": "7a646f28-2e14-4d62-b861-4a6c04319a9e-attachment.txt", "type": "text/plain"}], "start": 1756432774382, "stop": 1756432774382}, {"name": "数据首次稳定", "status": "passed", "attachments": [{"name": "状态说明", "source": "c4effd91-8852-4618-a6c2-aff499c42845-attachment.txt", "type": "text/plain"}], "start": 1756432774382, "stop": 1756432774382}, {"name": "执行单次数据库查询", "status": "passed", "steps": [{"name": "执行数据库查询", "status": "passed", "attachments": [{"name": "执行SQL", "source": "d377960c-993b-47eb-8458-5655065b2db4-attachment.txt", "type": "text/plain"}, {"name": "SQL参数", "source": "2b8c3fcd-ec8c-4756-9c75-33daeb44f31d-attachment.txt", "type": "text/plain"}], "start": 1756432776437, "stop": 1756432777448}], "attachments": [{"name": "查询条件", "source": "e45ba49e-f771-4409-94d2-6a50c3fda7c6-attachment.txt", "type": "text/plain"}], "start": 1756432776437, "stop": 1756432777448}, {"name": "轮询中（已等待7.2秒）", "status": "passed", "attachments": [{"name": "当前状态", "source": "6e4bfb71-5a4a-4e99-8741-f7598d9b5b6f-attachment.txt", "type": "text/plain"}, {"name": "超时倒计时", "source": "e1233768-fe6f-4464-aa81-7d488f219d15-attachment.txt", "type": "text/plain"}], "start": 1756432777448, "stop": 1756432777449}, {"name": "判断结果稳定性", "status": "passed", "attachments": [{"name": "判断结果", "source": "aa497fbc-542e-489d-8618-010b860c378c-attachment.txt", "type": "text/plain"}], "start": 1756432777449, "stop": 1756432777449}, {"name": "数据稳定达标", "status": "passed", "attachments": [{"name": "结果说明", "source": "a8883b7c-16b3-440b-8931-a8c001725bc7-attachment.txt", "type": "text/plain"}], "start": 1756432777450, "stop": 1756432777451}, {"name": "数据库查询结果（最终稳定结果）", "status": "passed", "attachments": [{"name": "查询结果（共31条，显示前50条）", "source": "a333f74f-7976-4dec-a1ca-d6dfa3a0a863-attachment.json", "type": "application/json"}], "start": 1756432777451, "stop": 1756432777452}], "attachments": [{"name": "执行SQL", "source": "6b91ae02-9a94-40be-bc29-6399c717b216-attachment.txt", "type": "text/plain"}, {"name": "SQL参数", "source": "978b2baa-6096-4834-b887-d3c51759f76b-attachment.txt", "type": "text/plain"}, {"name": "时间范围", "source": "41ef3076-6e5d-4476-a76f-f35c3155ed78-attachment.txt", "type": "text/plain"}], "start": 1756432770258, "stop": 1756432777452}], "start": 1756432770258, "stop": 1756432777452}, {"name": "2. 校验数据", "status": "failed", "statusDetails": {"message": "AssertionError: 修改币种下单总手数应该是0.02或者0.03，如果币种不在交易时间就是1，实际是：21.0\nassert (False or False or False)\n +  where False = <built-in function isclose>(21.0, 0.02, rel_tol=1e-09)\n +    where <built-in function isclose> = math.isclose\n +  and   False = <built-in function isclose>(21.0, 0.03, rel_tol=1e-09)\n +    where <built-in function isclose> = math.isclose\n +  and   False = <built-in function isclose>(21.0, 1.0, rel_tol=1e-09)\n +    where <built-in function isclose> = math.isclose\n", "trace": "  File \"D:\\pycharm_test\\lingkuan_828\\test_cloudTrader\\test_cloudtrader_money_scene.py\", line 458, in test_dbclose_cfdp\n    assert (math.isclose(addsalve_size_cfdp_total, 0.02, rel_tol=1e-9) or\n"}, "start": 1756432777452, "stop": 1756432777454}], "attachments": [{"name": "log", "source": "ec06dd8d-949b-4e7f-a029-3755fd5181f8-attachment.txt", "type": "text/plain"}], "start": 1756432770258, "stop": 1756432777454, "uuid": "5c4a7bb6-42a0-4244-9336-ad4e1fc82e26", "historyId": "3c81c7e8d4325331f3ef0909166b72d7", "testCaseId": "3c81c7e8d4325331f3ef0909166b72d7", "fullName": "test_cloudTrader.test_cloudtrader_money_scene.Testcloudtrader_money#test_dbclose_cfdp", "labels": [{"name": "feature", "value": "云策略-云策略列表-修改跟单账号"}, {"name": "story", "value": "场景1：云策略-云策略列表-云跟单账号修改币种"}, {"name": "parentSuite", "value": "test_cloudTrader"}, {"name": "suite", "value": "test_cloudtrader_money_scene"}, {"name": "subSuite", "value": "Testcloudtrader_moneyandscene"}, {"name": "host", "value": "DESKTOP-4S9CU1E"}, {"name": "thread", "value": "21760-MainThread"}, {"name": "framework", "value": "pytest"}, {"name": "language", "value": "cpython3"}, {"name": "package", "value": "test_cloudTrader.test_cloudtrader_money_scene"}]}