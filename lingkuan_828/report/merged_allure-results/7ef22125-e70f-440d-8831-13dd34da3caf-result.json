{"name": "数据库校验-云跟单账号策略平仓-修改币种p", "status": "failed", "statusDetails": {"message": "AssertionError: 修改币种下单总手数应该是0.02或者0.03，如果币种不在交易时间就是1，实际是：21.0\nassert (False or False or False)\n +  where False = <built-in function isclose>(21.0, 0.02, rel_tol=1e-09)\n +    where <built-in function isclose> = math.isclose\n +  and   False = <built-in function isclose>(21.0, 0.03, rel_tol=1e-09)\n +    where <built-in function isclose> = math.isclose\n +  and   False = <built-in function isclose>(21.0, 1.0, rel_tol=1e-09)\n +    where <built-in function isclose> = math.isclose", "trace": "self = <lingkuan_828.test_cloudTrader.test_cloudtrader_money_scene.Testcloudtrader_moneyandscene.Testcloudtrader_money object at 0x0000012EF6132D90>\nvar_manager = <lingkuan_828.commons.variable_manager.VariableManager object at 0x0000012EF7623640>\ndb_transaction = <pymysql.connections.Connection object at 0x0000012EF75C4FD0>\n\n    @allure.title(\"数据库校验-云跟单账号策略平仓-修改币种p\")\n    def test_dbclose_cfdp(self, var_manager, db_transaction):\n        with allure.step(\"1. 获取订单详情表账号数据\"):\n            cloudTrader_user_accounts_9 = var_manager.get_variable(\"cloudTrader_user_accounts_9\")\n            sql = f\"\"\"\n                    SELECT\n                        fod.size,\n                        fod.close_no,\n                        fod.symbol,\n                        fod.order_no,\n                        foi.true_total_lots,\n                        foi.order_no,\n                        foi.operation_type,\n                        foi.create_time,\n                        foi.status\n                    FROM\n                        follow_order_detail fod\n                    INNER JOIN\n                        follow_order_instruct foi\n                    ON\n                        foi.order_no = fod.close_no COLLATE utf8mb4_0900_ai_ci\n                    WHERE foi.operation_type=%s\n                        AND fod.account = %s\n                        \"\"\"\n            params = (\n                '1',\n                cloudTrader_user_accounts_9,\n            )\n    \n            # 调用轮询等待方法（带时间范围过滤）\n            db_data = self.query_database_with_time(\n                db_transaction=db_transaction,\n                sql=sql,\n                params=params,\n                time_field=\"foi.create_time\"\n            )\n    \n        with allure.step(\"2. 校验数据\"):\n            if not db_data:\n                pytest.fail(\"数据库查询结果为空，无法提取数据\")\n    \n            addsalve_size_cfdp_close = [record[\"size\"] for record in db_data]\n            var_manager.set_runtime_variable(\"addsalve_size_cfdp_close\", addsalve_size_cfdp_close)\n            addsalve_size_cfdp_total = sum(addsalve_size_cfdp_close)\n>           assert (math.isclose(addsalve_size_cfdp_total, 0.02, rel_tol=1e-9) or\n                    math.isclose(addsalve_size_cfdp_total, 0.03, rel_tol=1e-9) or\n                    math.isclose(addsalve_size_cfdp_total, 1.0,\n                                 rel_tol=1e-9)), f\"修改币种下单总手数应该是0.02或者0.03，如果币种不在交易时间就是1，实际是：{addsalve_size_cfdp_total}\"\nE           AssertionError: 修改币种下单总手数应该是0.02或者0.03，如果币种不在交易时间就是1，实际是：21.0\nE           assert (False or False or False)\nE            +  where False = <built-in function isclose>(21.0, 0.02, rel_tol=1e-09)\nE            +    where <built-in function isclose> = math.isclose\nE            +  and   False = <built-in function isclose>(21.0, 0.03, rel_tol=1e-09)\nE            +    where <built-in function isclose> = math.isclose\nE            +  and   False = <built-in function isclose>(21.0, 1.0, rel_tol=1e-09)\nE            +    where <built-in function isclose> = math.isclose\n\ntest_cloudTrader\\test_cloudtrader_money_scene.py:458: AssertionError"}, "description": "\n    ### 用例说明\n    - 前置条件：有云策略和云跟单\n    - 操作步骤：\n      1. 有三个账号，分别修改三个账号的后缀.@ .p .min\n      2. 进行开仓\n      3. 判断三个账号的币种手数是否正确\n      4. 进行平仓\n      5. 判断三个账号的币种手数是否正确\n    - 预期结果：三个账号的币种手数正确\n    ", "steps": [{"name": "1. 获取订单详情表账号数据", "status": "passed", "steps": [{"name": "轮询等待数据稳定（超时: 30秒，稳定期: 2秒）", "status": "passed", "steps": [{"name": "执行单次数据库查询", "status": "passed", "steps": [{"name": "执行数据库查询", "status": "passed", "attachments": [{"name": "执行SQL", "source": "a7ded034-46cb-49d5-b4d1-a2731928d006-attachment.txt", "type": "text/plain"}, {"name": "SQL参数", "source": "94f464b3-5cd2-4ff9-b95e-3388781f233a-attachment.txt", "type": "text/plain"}], "start": 1756432757746, "stop": 1756432758676}], "attachments": [{"name": "查询条件", "source": "2a8bd532-1233-4c5f-a299-524804540f86-attachment.txt", "type": "text/plain"}], "start": 1756432757745, "stop": 1756432758676}, {"name": "轮询中（已等待1.0秒）", "status": "passed", "attachments": [{"name": "当前状态", "source": "846b77e6-f507-4f58-b996-07eb10d5f869-attachment.txt", "type": "text/plain"}, {"name": "超时倒计时", "source": "e30ce0e6-85e1-4135-b47e-b8c7fa7a3d81-attachment.txt", "type": "text/plain"}], "start": 1756432758676, "stop": 1756432758678}, {"name": "判断结果稳定性", "status": "passed", "attachments": [{"name": "判断结果", "source": "d727c573-5151-4aa5-b60c-78b42248107e-attachment.txt", "type": "text/plain"}], "start": 1756432758678, "stop": 1756432758678}, {"name": "数据发生变化", "status": "passed", "attachments": [{"name": "状态说明", "source": "a1170ac0-118e-42b2-a6af-b140da1f3a18-attachment.txt", "type": "text/plain"}], "start": 1756432758678, "stop": 1756432758679}, {"name": "执行单次数据库查询", "status": "passed", "steps": [{"name": "执行数据库查询", "status": "passed", "attachments": [{"name": "执行SQL", "source": "a3097f7d-8fd5-4de0-8967-6a81c070506b-attachment.txt", "type": "text/plain"}, {"name": "SQL参数", "source": "917b7c67-0baa-4663-8806-107749bc38d7-attachment.txt", "type": "text/plain"}], "start": 1756432760729, "stop": 1756432761709}], "attachments": [{"name": "查询条件", "source": "59c927cc-783a-41ae-b685-891428dd0990-attachment.txt", "type": "text/plain"}], "start": 1756432760728, "stop": 1756432761709}, {"name": "轮询中（已等待4.0秒）", "status": "passed", "attachments": [{"name": "当前状态", "source": "bf70504b-fece-4f5b-ac52-96b3348869f9-attachment.txt", "type": "text/plain"}, {"name": "超时倒计时", "source": "910bfccb-8711-449a-a15b-9dd85814b6e6-attachment.txt", "type": "text/plain"}], "start": 1756432761709, "stop": 1756432761711}, {"name": "判断结果稳定性", "status": "passed", "attachments": [{"name": "判断结果", "source": "a30c2b74-c39a-4a02-8a8b-5f4d648a1dd9-attachment.txt", "type": "text/plain"}], "start": 1756432761711, "stop": 1756432761712}, {"name": "数据首次稳定", "status": "passed", "attachments": [{"name": "状态说明", "source": "4694fc69-1b43-45d4-99eb-527e868b1b3e-attachment.txt", "type": "text/plain"}], "start": 1756432761712, "stop": 1756432761712}, {"name": "执行单次数据库查询", "status": "passed", "steps": [{"name": "执行数据库查询", "status": "passed", "attachments": [{"name": "执行SQL", "source": "d62df775-60d2-4c52-9cd9-8cc16ec1a8f4-attachment.txt", "type": "text/plain"}, {"name": "SQL参数", "source": "3eb99c29-dfa0-4304-a721-062b79797fcd-attachment.txt", "type": "text/plain"}], "start": 1756432763764, "stop": 1756432764681}], "attachments": [{"name": "查询条件", "source": "6afc5a2a-c28c-4f43-95f4-446c7cb9b148-attachment.txt", "type": "text/plain"}], "start": 1756432763764, "stop": 1756432764681}, {"name": "轮询中（已等待7.0秒）", "status": "passed", "attachments": [{"name": "当前状态", "source": "dc70f78e-62fe-4dfe-9331-c7a7051f4578-attachment.txt", "type": "text/plain"}, {"name": "超时倒计时", "source": "52fc6290-db32-4366-b3a5-43d0e456da7c-attachment.txt", "type": "text/plain"}], "start": 1756432764681, "stop": 1756432764682}, {"name": "判断结果稳定性", "status": "passed", "attachments": [{"name": "判断结果", "source": "f7ca1368-bcb2-4a30-811c-7b53d8bec2bf-attachment.txt", "type": "text/plain"}], "start": 1756432764682, "stop": 1756432764683}, {"name": "数据稳定达标", "status": "passed", "attachments": [{"name": "结果说明", "source": "97b01fee-335a-4647-b2c9-df128fa4c40f-attachment.txt", "type": "text/plain"}], "start": 1756432764683, "stop": 1756432764684}, {"name": "数据库查询结果（最终稳定结果）", "status": "passed", "attachments": [{"name": "查询结果（共31条，显示前50条）", "source": "7f027754-c1a2-4e20-83b1-a3a8b9439fe1-attachment.json", "type": "application/json"}], "start": 1756432764684, "stop": 1756432764684}], "attachments": [{"name": "执行SQL", "source": "6b1e36ca-a9aa-4d4e-aa6d-78eb4aedf71a-attachment.txt", "type": "text/plain"}, {"name": "SQL参数", "source": "f0df0ea6-f146-4052-bc51-1648ffa4b577-attachment.txt", "type": "text/plain"}, {"name": "时间范围", "source": "870fff88-de98-46c5-b7cb-0eb76f38ce84-attachment.txt", "type": "text/plain"}], "start": 1756432757699, "stop": 1756432764684}], "start": 1756432757699, "stop": 1756432764684}, {"name": "2. 校验数据", "status": "failed", "statusDetails": {"message": "AssertionError: 修改币种下单总手数应该是0.02或者0.03，如果币种不在交易时间就是1，实际是：21.0\nassert (False or False or False)\n +  where False = <built-in function isclose>(21.0, 0.02, rel_tol=1e-09)\n +    where <built-in function isclose> = math.isclose\n +  and   False = <built-in function isclose>(21.0, 0.03, rel_tol=1e-09)\n +    where <built-in function isclose> = math.isclose\n +  and   False = <built-in function isclose>(21.0, 1.0, rel_tol=1e-09)\n +    where <built-in function isclose> = math.isclose\n", "trace": "  File \"D:\\pycharm_test\\lingkuan_828\\test_cloudTrader\\test_cloudtrader_money_scene.py\", line 458, in test_dbclose_cfdp\n    assert (math.isclose(addsalve_size_cfdp_total, 0.02, rel_tol=1e-9) or\n"}, "start": 1756432764684, "stop": 1756432764685}], "attachments": [{"name": "log", "source": "6a141e38-0451-45c2-85d6-408c2cdd96e0-attachment.txt", "type": "text/plain"}], "start": 1756432757698, "stop": 1756432764686, "uuid": "35851ad9-2149-4f93-9027-096553c2e6cf", "historyId": "3c81c7e8d4325331f3ef0909166b72d7", "testCaseId": "3c81c7e8d4325331f3ef0909166b72d7", "fullName": "test_cloudTrader.test_cloudtrader_money_scene.Testcloudtrader_money#test_dbclose_cfdp", "labels": [{"name": "feature", "value": "云策略-云策略列表-修改跟单账号"}, {"name": "story", "value": "场景1：云策略-云策略列表-云跟单账号修改币种"}, {"name": "parentSuite", "value": "test_cloudTrader"}, {"name": "suite", "value": "test_cloudtrader_money_scene"}, {"name": "subSuite", "value": "Testcloudtrader_moneyandscene"}, {"name": "host", "value": "DESKTOP-4S9CU1E"}, {"name": "thread", "value": "21760-MainThread"}, {"name": "framework", "value": "pytest"}, {"name": "language", "value": "cpython3"}, {"name": "package", "value": "test_cloudTrader.test_cloudtrader_money_scene"}]}