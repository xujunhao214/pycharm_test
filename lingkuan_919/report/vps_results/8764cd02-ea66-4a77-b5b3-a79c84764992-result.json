{"name": "数据库校验-VPS数据-批量新增跟单账号", "status": "failed", "statusDetails": {"message": "AssertionError: 账号净值euqit有钱，实际金额为: 0.0\nassert 0.0 > 0", "trace": "self = <lingkuan_919.test_vps.test_create_scene.TestCreate_Scene object at 0x0000024C1870E2B0>\nvar_manager = <lingkuan_919.commons.variable_manager.VariableManager object at 0x0000024C1870E940>\ndb_transaction = <pymysql.connections.Connection object at 0x0000024C1870EBE0>\n\n    @allure.title(\"数据库校验-VPS数据-批量新增跟单账号\")\n    def test_dbimport_addSlave(self, var_manager, db_transaction):\n        # 1. 校验总用户数（需至少7个，才能取后6个）\n        vps_user_count = var_manager.get_variable(\"vps_user_count\", 0)\n        if vps_user_count < 7:\n            pytest.fail(f\"用户总数需至少为7，当前为{vps_user_count}，无法提取后6个数据进行校验\")\n    \n        # 2. 提取后6个账号（对应vps_user_accounts_2到vps_user_accounts_7）\n        all_accounts = []\n        for i in range(2, 8):  # 直接指定取第2到第7个账号（共6个）\n            account = var_manager.get_variable(f\"vps_user_accounts_{i}\")\n            if not account:\n                pytest.fail(f\"未找到第{i}个账号（变量：vps_user_accounts_{i}）\")\n            all_accounts.append(account)\n        print(f\"将校验的后6个账号：{all_accounts}\")\n    \n        # 3. 初始化ID列表和计数器\n        all_ids = []\n        vps_addslave_count = 0\n    \n        # 4. 逐个校验后6个账号的数据库记录\n        for idx, account in enumerate(all_accounts, 1):  # idx从1开始（1-6，对应6个账号）\n            with allure.step(f\"验证第{idx}个账号（{account}）的数据库记录\"):\n                sql = f\"SELECT * FROM follow_trader WHERE account = %s\"\n                params = (account,)\n    \n                # 调用轮询等待方法（带时间范围过滤）\n                db_data = self.query_database_with_time(\n                    db_transaction=db_transaction,\n                    sql=sql,\n                    params=params,\n                    order_by=\"account ASC\"\n                )\n    \n                if not db_data:\n                    pytest.fail(f\"账号 {account} 在主表中未找到记录，请检查新增是否成功\")\n    \n                # 提取当前账号的ID并保存到变量管理器\n                vps_addslave_id = db_data[0][\"id\"]\n                all_ids.append(vps_addslave_id)\n                var_manager.set_runtime_variable(f\"vps_addslave_ids_{idx}\", vps_addslave_id)\n                print(f\"账号 {account} 的ID为：{vps_addslave_id}，已保存到变量 vps_addslave_ids_{idx}\")\n    \n            with allure.step(\"校验账号状态和净值（核心业务规则）\"):\n                status = db_data[0][\"status\"]\n                assert status == 0, f\"新增跟单账号状态status应为0（正常），实际状态为: {status}\"\n                logging.info(f\"新增跟单账号状态status应为0（正常），实际状态为: {status}\")\n    \n                euqit = db_data[0][\"euqit\"]\n>               assert euqit > 0, f\"账号净值euqit有钱，实际金额为: {euqit}\"\nE               AssertionError: 账号净值euqit有钱，实际金额为: 0.0\nE               assert 0.0 > 0\n\ntest_vps\\test_create_scene.py:194: AssertionError"}, "steps": [{"name": "验证第1个账号（31493）的数据库记录", "status": "passed", "steps": [{"name": "轮询等待数据稳定（超时: 30秒，稳定期: 2秒）", "status": "passed", "steps": [{"name": "执行单次数据库查询", "status": "passed", "steps": [{"name": "执行数据库查询", "status": "passed", "attachments": [{"name": "执行SQL", "source": "3cf5c1ea-f5ac-4bf1-8269-54fb31b86990-attachment.txt", "type": "text/plain"}, {"name": "SQL参数", "source": "3eb6c0a5-1355-4703-9051-a91e484ce4e9-attachment.txt", "type": "text/plain"}], "start": 1761614704854, "stop": 1761614705078}], "attachments": [{"name": "查询条件", "source": "0017e728-1969-41ff-8723-b60b04f3bac3-attachment.txt", "type": "text/plain"}], "start": 1761614704853, "stop": 1761614705078}, {"name": "轮询中（已等待0.3秒）", "status": "passed", "attachments": [{"name": "当前状态", "source": "8e2210a1-d65a-4461-ba40-11b26f0f5baa-attachment.txt", "type": "text/plain"}, {"name": "超时倒计时", "source": "ebc3cb6a-50c3-4e89-afe5-e0d0d7e31156-attachment.txt", "type": "text/plain"}], "start": 1761614705078, "stop": 1761614705079}, {"name": "判断结果稳定性", "status": "passed", "attachments": [{"name": "判断结果", "source": "e93624fb-94c0-4d2f-b01e-a6a548c81051-attachment.txt", "type": "text/plain"}], "start": 1761614705079, "stop": 1761614705080}, {"name": "数据发生变化", "status": "passed", "attachments": [{"name": "状态说明", "source": "3b1cc002-c4de-4fa1-9c80-0a0b13875321-attachment.txt", "type": "text/plain"}], "start": 1761614705080, "stop": 1761614705080}, {"name": "执行单次数据库查询", "status": "passed", "steps": [{"name": "执行数据库查询", "status": "passed", "attachments": [{"name": "执行SQL", "source": "30bbce60-7837-42b3-b4f6-567137fab40c-attachment.txt", "type": "text/plain"}, {"name": "SQL参数", "source": "16930689-4081-4183-b536-9a6b3f595485-attachment.txt", "type": "text/plain"}], "start": 1761614707135, "stop": 1761614707882}], "attachments": [{"name": "查询条件", "source": "385b36f3-d924-48a0-ab4f-7e3c0a87168c-attachment.txt", "type": "text/plain"}], "start": 1761614707134, "stop": 1761614707882}, {"name": "轮询中（已等待3.1秒）", "status": "passed", "attachments": [{"name": "当前状态", "source": "9e9c3bdb-98f5-4ebc-a4c7-20270e09bdcf-attachment.txt", "type": "text/plain"}, {"name": "超时倒计时", "source": "0f705a53-c508-4e02-90da-1998e2e7b2bd-attachment.txt", "type": "text/plain"}], "start": 1761614707882, "stop": 1761614707884}, {"name": "判断结果稳定性", "status": "passed", "attachments": [{"name": "唯一键信息", "source": "dab26c0f-9635-46df-b683-188154f961cd-attachment.txt", "type": "text/plain"}, {"name": "判断结果", "source": "ab178c7d-622b-4981-bcbc-4477b260cea6-attachment.txt", "type": "text/plain"}], "start": 1761614707884, "stop": 1761614707885}, {"name": "数据首次稳定", "status": "passed", "attachments": [{"name": "状态说明", "source": "e3a5e0e6-b48a-45c3-a924-bb1ab2c831a2-attachment.txt", "type": "text/plain"}], "start": 1761614707885, "stop": 1761614707886}, {"name": "执行单次数据库查询", "status": "passed", "steps": [{"name": "执行数据库查询", "status": "passed", "attachments": [{"name": "执行SQL", "source": "cc10541d-cdfe-4f21-95c6-781cd088ece5-attachment.txt", "type": "text/plain"}, {"name": "SQL参数", "source": "a3759404-71ff-437c-b105-4ade1dae849f-attachment.txt", "type": "text/plain"}], "start": 1761614709949, "stop": 1761614710164}], "attachments": [{"name": "查询条件", "source": "f424e20f-918f-4430-b8fe-6ea3cefed89d-attachment.txt", "type": "text/plain"}], "start": 1761614709948, "stop": 1761614710164}, {"name": "轮询中（已等待5.4秒）", "status": "passed", "attachments": [{"name": "当前状态", "source": "fc3311b5-3f37-421c-b4b5-f69c07f27cb1-attachment.txt", "type": "text/plain"}, {"name": "超时倒计时", "source": "604a98ce-fd8d-4280-b2dd-5e35c6bafd56-attachment.txt", "type": "text/plain"}], "start": 1761614710164, "stop": 1761614710165}, {"name": "判断结果稳定性", "status": "passed", "attachments": [{"name": "唯一键信息", "source": "fe45bbdc-8306-4d6d-bc79-b30861379907-attachment.txt", "type": "text/plain"}, {"name": "判断结果", "source": "ae6022e8-cf03-45ad-ab17-1d5dd948c819-attachment.txt", "type": "text/plain"}], "start": 1761614710165, "stop": 1761614710166}, {"name": "数据稳定达标", "status": "passed", "attachments": [{"name": "结果说明", "source": "b03083ab-45d8-4f79-8648-a5f77412757d-attachment.txt", "type": "text/plain"}], "start": 1761614710166, "stop": 1761614710167}, {"name": "数据库查询结果（最终稳定结果）", "status": "passed", "attachments": [{"name": "查询结果（共1条，显示前50条）", "source": "fb4b4a25-9878-4f57-bb0a-8eb5946ff15e-attachment.json", "type": "application/json"}], "start": 1761614710167, "stop": 1761614710168}], "attachments": [{"name": "执行SQL", "source": "09bddeaf-6520-482f-b35c-c97c17af3051-attachment.txt", "type": "text/plain"}, {"name": "SQL参数", "source": "588ff418-c117-4c56-9499-e703e4b3f8a8-attachment.txt", "type": "text/plain"}, {"name": "查询时间窗口", "source": "c13c88dd-51dc-4d2a-b3c9-368f6d21f1da-attachment.txt", "type": "text/plain"}], "start": 1761614704802, "stop": 1761614710168}], "start": 1761614704801, "stop": 1761614710169}, {"name": "校验账号状态和净值（核心业务规则）", "status": "failed", "statusDetails": {"message": "AssertionError: 账号净值euqit有钱，实际金额为: 0.0\nassert 0.0 > 0\n", "trace": "  File \"D:\\pycharm_test\\lingkuan_919\\test_vps\\test_create_scene.py\", line 194, in test_dbimport_addSlave\n    assert euqit > 0, f\"账号净值euqit有钱，实际金额为: {euqit}\"\n"}, "start": 1761614710169, "stop": 1761614710169}], "attachments": [{"name": "log", "source": "30c36759-7fbf-4568-9042-6d8595f63f30-attachment.txt", "type": "text/plain"}], "start": 1761614704801, "stop": 1761614710170, "uuid": "a363a246-6ccd-4c90-8d99-91e17d4c12a7", "historyId": "5b943886b5c4f05887f323b30339137a", "testCaseId": "5b943886b5c4f05887f323b30339137a", "fullName": "test_vps.test_create_scene.TestCreate_Scene#test_dbimport_addSlave", "labels": [{"name": "feature", "value": "跟单软件看板-VPS数据-批量新增VPS跟单"}, {"name": "parentSuite", "value": "test_vps"}, {"name": "suite", "value": "test_create_scene"}, {"name": "subSuite", "value": "TestCreate_Scene"}, {"name": "host", "value": "DESKTOP-4S9CU1E"}, {"name": "thread", "value": "55976-MainThread"}, {"name": "framework", "value": "pytest"}, {"name": "language", "value": "cpython3"}, {"name": "package", "value": "test_vps.test_create_scene"}]}