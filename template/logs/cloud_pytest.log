INFO     - 2025-09-22 11:15:43 - [conftest:344] - [2025-09-22 11:15:43] 测试会话开始: 2025-09-22 11:15:43, 测试组: cloud
INFO     - 2025-09-22 11:15:43 - [variable_manager:40] - [2025-09-22 11:15:43] 成功加载静态变量: VAR\uat_data.json
INFO     - 2025-09-22 11:15:43 - [variable_manager:64] - [2025-09-22 11:15:43] 成功加载运行时变量: VAR\runtime_vars_cloud.json
INFO     - 2025-09-22 11:15:43 - [conftest:74] - [2025-09-22 11:15:43] 用例  开始登录，环境: uat
DEBUG    - 2025-09-22 11:15:43 - [connectionpool:1051] - Starting new HTTPS connection (1): dev.lgcopytrade.top:443
DEBUG    - 2025-09-22 11:15:45 - [connectionpool:546] - https://dev.lgcopytrade.top:443 "GET /api/sys/randomImage/1758510943964?_t=1758510943 HTTP/11" 200 None
INFO     - 2025-09-22 11:15:45 - [conftest:143] - 第1次尝试 - 验证码识别结果: 9yqa
DEBUG    - 2025-09-22 11:15:46 - [connectionpool:546] - https://dev.lgcopytrade.top:443 "POST /api/sys/login HTTP/11" 200 None
INFO     - 2025-09-22 11:15:46 - [conftest:186] - uat环境登录成功（第1次尝试）
INFO     - 2025-09-22 11:15:46 - [variable_manager:111] - [2025-09-22 11:15:43] 运行时变量已保存到: D:\pycharm_test\template\VAR\runtime_vars_cloud.json
DEBUG    - 2025-09-22 11:15:46 - [connectionpool:546] - https://dev.lgcopytrade.top:443 "PUT /api/blockchain/master-slave/editPa HTTP/11" 200 None
INFO     - 2025-09-22 11:15:46 - [api_base:339] - [2025-09-22 11:15:46] PUT请求: /blockchain/master-slave/editPa | 数据: {'id': '1969962083626766338', 'direction': 'FORWARD', 'followingMode': 2, 'fixedProportion': 100, 'fixedLots': None}
DEBUG    - 2025-09-22 11:15:50 - [connectionpool:546] - https://dev.lgcopytrade.top:443 "GET /api/online/cgreport/api/getColumnsAndData/1560189381093109761?_t=1758510943&account=301390787&pageNo=1&pageSize=20&status=NORMAL%2CAUDIT HTTP/11" 200 None
INFO     - 2025-09-22 11:15:50 - [api_base:257] - [2025-09-22 11:15:50] GET请求: /online/cgreport/api/getColumnsAndData/1560189381093109761 | 参数: {'_t': 1758510943, 'account': '301390787', 'pageNo': '1', 'pageSize': '20', 'status': 'NORMAL,AUDIT'}
INFO     - 2025-09-22 11:15:53 - [variable_manager:111] - [2025-09-22 11:15:43] 运行时变量已保存到: D:\pycharm_test\template\VAR\runtime_vars_cloud.json
DEBUG    - 2025-09-22 11:15:54 - [connectionpool:546] - https://dev.lgcopytrade.top:443 "GET /api/online/cgform/api/getData/402883977b38c9ca017b38c9caff0000?_t=1758510943&trader_id=1969961827138736130&column=id&order=desc&pageNo=1&pageSize=50&superQueryMatchType=and HTTP/11" 200 None
INFO     - 2025-09-22 11:15:54 - [api_base:257] - [2025-09-22 11:15:54] GET请求: /online/cgform/api/getData/402883977b38c9ca017b38c9caff0000 | 参数: {'_t': 1758510943, 'trader_id': '1969961827138736130', 'column': 'id', 'order': 'desc', 'pageNo': 1, 'pageSize': 50, 'superQueryMatchType': 'and'}
INFO     - 2025-09-22 11:15:57 - [test_oac_proportion:126] - 查询结果符合预期：records为空列表
DEBUG    - 2025-09-22 11:15:57 - [connectionpool:546] - https://dev.lgcopytrade.top:443 "GET /api/online/cgform/api/getData/402883977b38c9ca017b38c9caff0000?_t=1758510943&trader_id=1969961978502778881&column=id&order=desc&pageNo=1&pageSize=50&superQueryMatchType=and HTTP/11" 200 None
INFO     - 2025-09-22 11:15:57 - [api_base:257] - [2025-09-22 11:15:57] GET请求: /online/cgform/api/getData/402883977b38c9ca017b38c9caff0000 | 参数: {'_t': 1758510943, 'trader_id': '1969961978502778881', 'column': 'id', 'order': 'desc', 'pageNo': 1, 'pageSize': 50, 'superQueryMatchType': 'and'}
DEBUG    - 2025-09-22 11:16:21 - [connectionpool:546] - https://dev.lgcopytrade.top:443 "GET /api/online/cgform/api/getData/402883977b38c9ca017b38c9caff0000?_t=1758510943&trader_id=1969961978502778881&column=id&order=desc&pageNo=1&pageSize=50&superQueryMatchType=and HTTP/11" 200 None
INFO     - 2025-09-22 11:16:21 - [api_base:257] - [2025-09-22 11:16:21] GET请求: /online/cgform/api/getData/402883977b38c9ca017b38c9caff0000 | 参数: {'_t': 1758510943, 'trader_id': '1969961978502778881', 'column': 'id', 'order': 'desc', 'pageNo': 1, 'pageSize': 50, 'superQueryMatchType': 'and'}
DEBUG    - 2025-09-22 11:16:45 - [connectionpool:546] - https://dev.lgcopytrade.top:443 "GET /api/online/cgform/api/getData/402883977b38c9ca017b38c9caff0000?_t=1758510943&trader_id=1969961978502778881&column=id&order=desc&pageNo=1&pageSize=50&superQueryMatchType=and HTTP/11" 200 None
INFO     - 2025-09-22 11:16:45 - [api_base:257] - [2025-09-22 11:16:45] GET请求: /online/cgform/api/getData/402883977b38c9ca017b38c9caff0000 | 参数: {'_t': 1758510943, 'trader_id': '1969961978502778881', 'column': 'id', 'order': 'desc', 'pageNo': 1, 'pageSize': 50, 'superQueryMatchType': 'and'}
DEBUG    - 2025-09-22 11:17:08 - [connectionpool:546] - https://dev.lgcopytrade.top:443 "GET /api/online/cgform/api/getData/402883977b38c9ca017b38c9caff0000?_t=1758510943&trader_id=1969961978502778881&column=id&order=desc&pageNo=1&pageSize=50&superQueryMatchType=and HTTP/11" 200 None
INFO     - 2025-09-22 11:17:08 - [api_base:257] - [2025-09-22 11:17:08] GET请求: /online/cgform/api/getData/402883977b38c9ca017b38c9caff0000 | 参数: {'_t': 1758510943, 'trader_id': '1969961978502778881', 'column': 'id', 'order': 'desc', 'pageNo': 1, 'pageSize': 50, 'superQueryMatchType': 'and'}
DEBUG    - 2025-09-22 11:17:11 - [connectionpool:1051] - Starting new HTTPS connection (1): mt4.mtapi.io:443
DEBUG    - 2025-09-22 11:17:13 - [connectionpool:546] - https://mt4.mtapi.io:443 "GET /Connect?user=301390786&password=lrd1lff&host=185.96.247.214&port=2333&connectTimeoutSeconds=30 HTTP/11" 200 None
INFO     - 2025-09-22 11:17:13 - [test_oac_proportion:198] - 第1次登录尝试 - 响应内容: 96151315-f78e-4a68-be25-28182f52fcb8
INFO     - 2025-09-22 11:17:13 - [test_oac_proportion:203] - 第1次尝试成功 - 获取到token: 96151315-f78e-4a68-be25-28182f52fcb8
INFO     - 2025-09-22 11:17:13 - [test_oac_proportion:222] - 登录MT4账号获取token: 96151315-f78e-4a68-be25-28182f52fcb8
DEBUG    - 2025-09-22 11:17:13 - [connectionpool:1051] - Starting new HTTPS connection (1): mt4.mtapi.io:443
DEBUG    - 2025-09-22 11:17:14 - [connectionpool:546] - https://mt4.mtapi.io:443 "GET /OrderSend?id=96151315-f78e-4a68-be25-28182f52fcb8&symbol=XAUUSD&operation=Buy&volume=0.01&placedType=Client&price=0.00 HTTP/11" 200 906
INFO     - 2025-09-22 11:17:14 - [variable_manager:111] - [2025-09-22 11:15:43] 运行时变量已保存到: D:\pycharm_test\template\VAR\runtime_vars_cloud.json
INFO     - 2025-09-22 11:17:14 - [variable_manager:111] - [2025-09-22 11:15:43] 运行时变量已保存到: D:\pycharm_test\template\VAR\runtime_vars_cloud.json
INFO     - 2025-09-22 11:17:14 - [test_oac_proportion:238] - ticket: 86404876,lots_open:0.01
DEBUG    - 2025-09-22 11:17:15 - [connectionpool:546] - https://dev.lgcopytrade.top:443 "GET /api/online/cgform/api/getData/402883977b38c9ca017b38c9caff0000?_t=1758510943&trader_id=1969961827138736130&column=id&order=desc&pageNo=1&pageSize=50&superQueryMatchType=and HTTP/11" 200 None
INFO     - 2025-09-22 11:17:15 - [api_base:257] - [2025-09-22 11:17:15] GET请求: /online/cgform/api/getData/402883977b38c9ca017b38c9caff0000 | 参数: {'_t': 1758510943, 'trader_id': '1969961827138736130', 'column': 'id', 'order': 'desc', 'pageNo': 1, 'pageSize': 50, 'superQueryMatchType': 'and'}
INFO     - 2025-09-22 11:17:18 - [test_oac_proportion:272] - 喊单者手数是: 0.01
INFO     - 2025-09-22 11:17:18 - [variable_manager:111] - [2025-09-22 11:15:43] 运行时变量已保存到: D:\pycharm_test\template\VAR\runtime_vars_cloud.json
INFO     - 2025-09-22 11:17:18 - [api_base:1363] - 校验通过: 第 1 条记录的账号ID应为1969961827138736130

实际: 1969961827138736130
操作: ==
预期: 1969961827138736130

INFO     - 2025-09-22 11:17:18 - [api_base:1363] - 校验通过: 订单号数据正确

实际: 86404876
操作: ==
预期: 86404876

INFO     - 2025-09-22 11:17:18 - [test_oac_proportion:316] - 订单号数据正确,开仓订单号：86404876 喊单者订单号：86404876
INFO     - 2025-09-22 11:17:18 - [test_oac_proportion:320] - 喊单者手数是: 0.01
INFO     - 2025-09-22 11:17:18 - [api_base:1363] - 校验通过: 手数符合预期

实际: 0.01
操作: ==
预期: 0.01

INFO     - 2025-09-22 11:17:18 - [test_oac_proportion:330] - 喊单者手数：0.01 MT4开仓手数：0.01
INFO     - 2025-09-22 11:17:18 - [api_base:508] - [2025-09-22 11:17:18] 执行SQL: SELECT * FROM bchain_trader_subscribe_order WHERE master_ticket = %s ORDER BY create_time DESC 
参数: (86404876,)
INFO     - 2025-09-22 11:17:18 - [api_base:511] - [2025-09-22 11:17:18] 查询成功，结果数量: 1
INFO     - 2025-09-22 11:17:18 - [api_base:523] - [2025-09-22 11:17:18] 查询结果: [{"id": "1969964149791248386", "master_id": "1969961827138736130", "master_ticket": 86404876, "master_type": 0, "master_open_time": "2025-09-22 06:17:07", "detected_open_time": "2025-09-22 11:17:08", "master_close_time": null, "detected_close_time": null, "master_lots": 0.01, "comment": "", "master_profit": null, "master_symbol": "XAUUSD", "slave_id": "1969961978502778881", "slave_ticket": 86404877, "slave_type": 0, "slave_open_time": "2025-09-22 11:17:08", "slave_receive_time": "2025-09-22 11:17:08", "slave_close_time": null, "slave_receive_close_time": null, "slave_lots": 0.01, "slave_position": null, "slave_profit": null, "slave_open_price": null, "slave_symbol": "XAUUSD", "slave_comment": null, "following_mode": 2, "fixed_lots": null, "fixed_proportion": 100, "ratio": 1.0, "flag": 1, "direction": "FORWARD", "extra": "[开仓]即时价格成交", "delete_flag": null, "award_status": null, "create_by": null, "create_time": "2025-09-22 11:17:08", "update_by": null, "update_time": null, "close_order_agent_id": null, "master_or_slave": 0, "commission_status": 0, "open_order_agent_id": "e9ca23d68d884d4ebb19d07889727dae", "close_extra": null, "open_time_difference": 314, "close_time_difference": null, "open_price_difference": 0.0, "close_price_difference": null}]
INFO     - 2025-09-22 11:17:18 - [test_oac_proportion:352] - 跟单账号订单号: 86404877
INFO     - 2025-09-22 11:17:18 - [variable_manager:111] - [2025-09-22 11:15:43] 运行时变量已保存到: D:\pycharm_test\template\VAR\runtime_vars_cloud.json
INFO     - 2025-09-22 11:17:18 - [test_oac_proportion:357] - 开仓时间差（毫秒）: 314
INFO     - 2025-09-22 11:17:18 - [variable_manager:111] - [2025-09-22 11:15:43] 运行时变量已保存到: D:\pycharm_test\template\VAR\runtime_vars_cloud.json
DEBUG    - 2025-09-22 11:17:19 - [connectionpool:546] - https://dev.lgcopytrade.top:443 "GET /api/online/cgform/api/getData/402883977b38c9ca017b38c9caff0000?_t=1758510943&trader_id=1969961978502778881&column=id&order=desc&pageNo=1&pageSize=50&superQueryMatchType=and HTTP/11" 200 None
INFO     - 2025-09-22 11:17:19 - [api_base:257] - [2025-09-22 11:17:19] GET请求: /online/cgform/api/getData/402883977b38c9ca017b38c9caff0000 | 参数: {'_t': 1758510943, 'trader_id': '1969961978502778881', 'column': 'id', 'order': 'desc', 'pageNo': 1, 'pageSize': 50, 'superQueryMatchType': 'and'}
INFO     - 2025-09-22 11:17:22 - [variable_manager:111] - [2025-09-22 11:15:43] 运行时变量已保存到: D:\pycharm_test\template\VAR\runtime_vars_cloud.json
INFO     - 2025-09-22 11:17:22 - [api_base:1363] - 校验通过: 第 1 条记录的账号ID应为1969961978502778881

实际: 1969961978502778881
操作: ==
预期: 1969961978502778881

INFO     - 2025-09-22 11:17:22 - [api_base:1363] - 校验通过: 订单号数据正确

实际: 86404876
操作: ==
预期: 86404876

INFO     - 2025-09-22 11:17:22 - [test_oac_proportion:437] - 订单号数据正确,开仓订单号：86404876 喊单者订单号：86404876
INFO     - 2025-09-22 11:17:22 - [api_base:1363] - 校验通过: 订单号数据正确

实际: 86404877
操作: ==
预期: 86404877

INFO     - 2025-09-22 11:17:22 - [test_oac_proportion:449] - 订单号数据正确,跟单者订单号：86404877 数据库数据：86404877
INFO     - 2025-09-22 11:17:22 - [api_base:1363] - 校验通过: 手数符合预期

实际: 0.01
操作: ==
预期: 0.01

INFO     - 2025-09-22 11:17:22 - [test_oac_proportion:478] - 跟单者手数：0.01
DEBUG    - 2025-09-22 11:17:23 - [connectionpool:546] - https://dev.lgcopytrade.top:443 "GET /api/online/cgform/api/getData/2c934301834efb6801834efbe1ba0002?_t=1758510943&master_account=301390786&column=id&order=desc&pageNo=1&pageSize=50&superQueryMatchType=and HTTP/11" 200 None
INFO     - 2025-09-22 11:17:23 - [api_base:257] - [2025-09-22 11:17:23] GET请求: /online/cgform/api/getData/2c934301834efb6801834efbe1ba0002 | 参数: {'_t': 1758510943, 'master_account': '301390786', 'column': 'id', 'order': 'desc', 'pageNo': 1, 'pageSize': 50, 'superQueryMatchType': 'and'}
INFO     - 2025-09-22 11:17:26 - [api_base:1363] - 校验通过: 第 1 条记录的订单号应为86404876

实际: 86404876
操作: ==
预期: 86404876

INFO     - 2025-09-22 11:17:26 - [api_base:1363] - 校验通过: 喊单者手数符合预期

实际: 0.01
操作: ==
预期: 0.01

INFO     - 2025-09-22 11:17:26 - [test_oac_proportion:551] - 喊单者手数验证通过: 0.01
INFO     - 2025-09-22 11:17:26 - [api_base:1363] - 校验通过: 交易币种符合预期

实际: XAUUSD
操作: ==
预期: XAUUSD

INFO     - 2025-09-22 11:17:26 - [test_oac_proportion:566] - 交易币种验证通过: XAUUSD
DEBUG    - 2025-09-22 11:17:26 - [connectionpool:546] - https://dev.lgcopytrade.top:443 "GET /api/online/cgreport/api/getColumnsAndData/1568899025974796289?_t=1758510943&pageNo=1&pageSize=50&self_master_ticket=86404876 HTTP/11" 200 None
INFO     - 2025-09-22 11:17:26 - [api_base:257] - [2025-09-22 11:17:26] GET请求: /online/cgreport/api/getColumnsAndData/1568899025974796289 | 参数: {'_t': 1758510943, 'pageNo': 1, 'pageSize': 50, 'self_master_ticket': 86404876}
INFO     - 2025-09-22 11:17:29 - [api_base:1363] - 校验通过: 第 1 条记录的订单号应为86404877

实际: 86404877
操作: ==
预期: 86404877

INFO     - 2025-09-22 11:17:29 - [api_base:1363] - 校验通过: 喊单者订单号符合预期

实际: 86404876
操作: ==
预期: 86404876

INFO     - 2025-09-22 11:17:29 - [test_oac_proportion:638] - 喊单者订单号验证通过: 86404876
INFO     - 2025-09-22 11:17:29 - [api_base:1363] - 校验通过: 喊单者手数符合预期

实际: 0.01
操作: ==
预期: 0.01

INFO     - 2025-09-22 11:17:29 - [test_oac_proportion:652] - 喊单者手数验证通过: 0.01
INFO     - 2025-09-22 11:17:29 - [api_base:1363] - 校验通过: 跟单手数符合预期

实际: 0.01
操作: ==
预期: 0.01

INFO     - 2025-09-22 11:17:29 - [test_oac_proportion:679] - 跟单手数验证通过: 0.01
INFO     - 2025-09-22 11:17:29 - [api_base:1363] - 校验通过: 交易币种符合预期

实际: XAUUSD
操作: ==
预期: XAUUSD

INFO     - 2025-09-22 11:17:29 - [test_oac_proportion:694] - 交易币种验证通过: XAUUSD
DEBUG    - 2025-09-22 11:17:30 - [connectionpool:546] - https://dev.lgcopytrade.top:443 "GET /api/blockchain/account/getRecordList?_t=1758510943&pageNo=1&pageSize=50&accountLike=301390786&serverNameLike=&connectTraderLike=&connected=&runIpAddr=39.103.138.2 HTTP/11" 200 None
INFO     - 2025-09-22 11:17:30 - [api_base:257] - [2025-09-22 11:17:30] GET请求: /blockchain/account/getRecordList | 参数: {'_t': 1758510943, 'pageNo': '1', 'pageSize': '50', 'accountLike': '301390786', 'serverNameLike': '', 'connectTraderLike': '', 'connected': '', 'runIpAddr': '39.103.138.2'}
INFO     - 2025-09-22 11:17:33 - [test_oac_proportion:731] - 手数是: 0.01
INFO     - 2025-09-22 11:17:33 - [api_base:1363] - 校验通过: 手数符合预期

实际: 0.01
操作: ==
预期: 0.01

INFO     - 2025-09-22 11:17:33 - [test_oac_proportion:742] - 喊单者手数：0.01 MT4开仓手数：0.01
DEBUG    - 2025-09-22 11:17:33 - [connectionpool:546] - https://dev.lgcopytrade.top:443 "GET /api/blockchain/account/getRecordList?_t=1758510943&pageNo=1&pageSize=50&accountLike=301390787&serverNameLike=&connectTraderLike=&connected=&runIpAddr=39.103.138.2 HTTP/11" 200 None
INFO     - 2025-09-22 11:17:33 - [api_base:257] - [2025-09-22 11:17:33] GET请求: /blockchain/account/getRecordList | 参数: {'_t': 1758510943, 'pageNo': '1', 'pageSize': '50', 'accountLike': '301390787', 'serverNameLike': '', 'connectTraderLike': '', 'connected': '', 'runIpAddr': '39.103.138.2'}
INFO     - 2025-09-22 11:17:37 - [test_oac_proportion:777] - 手数是: 8.00
DEBUG    - 2025-09-22 11:17:57 - [connectionpool:546] - https://dev.lgcopytrade.top:443 "GET /api/blockchain/account/getRecordList?_t=1758510943&pageNo=1&pageSize=50&accountLike=301390787&serverNameLike=&connectTraderLike=&connected=&runIpAddr=39.103.138.2 HTTP/11" 200 None
INFO     - 2025-09-22 11:17:57 - [api_base:257] - [2025-09-22 11:17:57] GET请求: /blockchain/account/getRecordList | 参数: {'_t': 1758510943, 'pageNo': '1', 'pageSize': '50', 'accountLike': '301390787', 'serverNameLike': '', 'connectTraderLike': '', 'connected': '', 'runIpAddr': '39.103.138.2'}
INFO     - 2025-09-22 11:18:00 - [test_oac_proportion:777] - 手数是: 8.00
DEBUG    - 2025-09-22 11:18:21 - [connectionpool:546] - https://dev.lgcopytrade.top:443 "GET /api/blockchain/account/getRecordList?_t=1758510943&pageNo=1&pageSize=50&accountLike=301390787&serverNameLike=&connectTraderLike=&connected=&runIpAddr=39.103.138.2 HTTP/11" 200 None
INFO     - 2025-09-22 11:18:21 - [api_base:257] - [2025-09-22 11:18:21] GET请求: /blockchain/account/getRecordList | 参数: {'_t': 1758510943, 'pageNo': '1', 'pageSize': '50', 'accountLike': '301390787', 'serverNameLike': '', 'connectTraderLike': '', 'connected': '', 'runIpAddr': '39.103.138.2'}
INFO     - 2025-09-22 11:18:24 - [test_oac_proportion:777] - 手数是: 8.01
DEBUG    - 2025-09-22 11:18:45 - [connectionpool:546] - https://dev.lgcopytrade.top:443 "GET /api/blockchain/account/getRecordList?_t=1758510943&pageNo=1&pageSize=50&accountLike=301390787&serverNameLike=&connectTraderLike=&connected=&runIpAddr=39.103.138.2 HTTP/11" 200 None
INFO     - 2025-09-22 11:18:45 - [api_base:257] - [2025-09-22 11:18:45] GET请求: /blockchain/account/getRecordList | 参数: {'_t': 1758510943, 'pageNo': '1', 'pageSize': '50', 'accountLike': '301390787', 'serverNameLike': '', 'connectTraderLike': '', 'connected': '', 'runIpAddr': '39.103.138.2'}
INFO     - 2025-09-22 11:18:48 - [test_oac_proportion:777] - 手数是: 8.01
DEBUG    - 2025-09-22 11:18:48 - [connectionpool:1051] - Starting new HTTPS connection (1): mt4.mtapi.io:443
DEBUG    - 2025-09-22 11:18:49 - [connectionpool:546] - https://mt4.mtapi.io:443 "GET /OrderClose?id=96151315-f78e-4a68-be25-28182f52fcb8&ticket=86404876&price=0.00 HTTP/11" 201 2263
INFO     - 2025-09-22 11:18:49 - [test_oac_proportion:826] - 第1次平仓响应: {'message': 'Client with id = 96151315-f78e-4a68-be25-28182f52fcb8 not found. Please use /Connect to create new token. Headers = Content-Type : application/json___Accept : */*___Accept-Encoding : gzip, deflate___Authorization : e5f9f574-fd0a-42bd-904b-3a7a088de27e___Host : mt4.mtapi.io___User-Agent : Apifox/1.0.0 (https://apifox.com)___x-sign : 417B110F1E71BD2CFE96366E67849B0B___x-forwarded-for : 14.153.94.232___x-forwarded-proto : https___x-envoy-external-address : 14.153.94.232___x-request-id : 89045f66-f993-9f59-8cda-5c23ee772ef5___x-envoy-decorator-operation : mt4resttrial.rest.svc.cluster.local:8050/*___x-envoy-peer-metadata : ChQKDkFQUF9DT05UQUlORVJTEgIaAAoaCgpDTFVTVEVSX0lEEgwaCkt1YmVybmV0ZXMKHQoMSU5TVEFOQ0VfSVBTEg0aCzEwLjEuNTguMjIwChkKDUlTVElPX1ZFUlNJT04SCBoGMS4xOC4yCpwDCgZMQUJFTFMSkQMqjgMKHQoDYXBwEhYaFGlzdGlvLWluZ3Jlc3NnYXRld2F5ChMKBWNoYXJ0EgoaCGdhdGV3YXlzChQKCGhlcml0YWdlEggaBlRpbGxlcgo2CilpbnN0YWxsLm9wZXJhdG9yLmlzdGlvLmlvL293bmluZy1yZXNvdXJjZRIJGgd1bmtub3duChkKBWlzdGlvEhAaDmluZ3Jlc3NnYXRld2F5ChkKDGlzdGlvLmlvL3JldhIJGgdkZWZhdWx0CjAKG29wZXJhdG9yLmlzdGlvLmlvL2NvbXBvbmVudBIRGg9JbmdyZXNzR2F0ZXdheXMKEgoHcmVsZWFzZRIHGgVpc3Rpbwo5Ch9zZXJ2aWNlLmlzdGlvLmlvL2Nhbm9uaWNhbC1uYW1lEhYaFGlzdGlvLWluZ3Jlc3NnYXRld2F5Ci8KI3NlcnZpY2UuaXN0aW8uaW8vY2Fub25pY2FsLXJldmlzaW9uEggaBmxhdGVzdAoiChdzaWRlY2FyLmlzdGlvLmlvL2luamVjdBIHGgVmYWxzZQoaCgdNRVNIX0lEEg8aDWNsdXN0ZXIubG9jYWwKLwoETkFNRRInGiVpc3Rpby1pbmdyZXNzZ2F0ZXdheS02OWM2OGI2Y2Q1LXI2d3drChsKCU5BTUVTUEFDRRIOGgxpc3Rpby1zeXN0ZW0KXQoFT1dORVISVBpSa3ViZXJuZXRlczovL2FwaXMvYXBwcy92MS9uYW1lc3BhY2VzL2lzdGlvLXN5c3RlbS9kZXBsb3ltZW50cy9pc3Rpby1pbmdyZXNzZ2F0ZXdheQoXChFQTEFURk9STV9NRVRBREFUQRICKgAKJwoNV09SS0xPQURfTkFNRRIWGhRpc3Rpby1pbmdyZXNzZ2F0ZXdheQ==___x-envoy-peer-metadata-id : router~10.1.58.220~istio-ingressgateway-69c68b6cd5-r6wwk.istio-system~istio-system.svc.cluster.local___x-envoy-attempt-count : 1___x-b3-traceid : c8174e07dca52ea9c06d50248278d5b4___x-b3-spanid : c06d50248278d5b4___x-b3-sampled : 1___', 'code': 'INVALID_TOKEN', 'stackTrace': '   at mtrestapi.MyControllerBase.GetClient(String id, String method) in /src/mt4rest/MyControllerBase.cs:line 75\n   at mtrestapi.Trading.OrderClose(String id, Int32 ticket, Double lots, Double price, Int32 slippage) in /src/mt4rest/Controllers/Trading.cs:line 261'}
WARNING  - 2025-09-22 11:18:49 - [test_oac_proportion:846] - 第1次平仓失败，未获取到平仓订单号
INFO     - 2025-09-22 11:18:49 - [test_oac_proportion:853] - 将在10秒后进行第2次尝试...
DEBUG    - 2025-09-22 11:18:59 - [connectionpool:1051] - Starting new HTTPS connection (1): mt4.mtapi.io:443
ERROR    - 2025-09-22 11:19:00 - [test_oac_proportion:209] - 第1次尝试发生异常: ('Connection aborted.', ConnectionResetError(10054, '远程主机强迫关闭了一个现有的连接。', None, 10054, None))
INFO     - 2025-09-22 11:19:00 - [test_oac_proportion:213] - 将在5秒后进行第2次重试...
DEBUG    - 2025-09-22 11:19:05 - [connectionpool:1051] - Starting new HTTPS connection (1): mt4.mtapi.io:443
DEBUG    - 2025-09-22 11:19:28 - [connectionpool:546] - https://mt4.mtapi.io:443 "GET /Connect?user=301390786&password=lrd1lff&host=185.96.247.214&port=2333&connectTimeoutSeconds=30 HTTP/11" 200 None
INFO     - 2025-09-22 11:19:28 - [test_oac_proportion:198] - 第2次登录尝试 - 响应内容: 96151315-f78e-4a68-be25-28182f52fcb8
INFO     - 2025-09-22 11:19:28 - [test_oac_proportion:203] - 第2次尝试成功 - 获取到token: 96151315-f78e-4a68-be25-28182f52fcb8
INFO     - 2025-09-22 11:19:28 - [test_oac_proportion:222] - 登录MT4账号获取token: 96151315-f78e-4a68-be25-28182f52fcb8
DEBUG    - 2025-09-22 11:19:28 - [connectionpool:1051] - Starting new HTTPS connection (1): mt4.mtapi.io:443
DEBUG    - 2025-09-22 11:19:32 - [connectionpool:546] - https://mt4.mtapi.io:443 "GET /OrderClose?id=96151315-f78e-4a68-be25-28182f52fcb8&ticket=86404876&price=0.00 HTTP/11" 200 915
INFO     - 2025-09-22 11:19:32 - [test_oac_proportion:826] - 第2次平仓响应: {'ticket': 86404876, 'openTime': '2025-09-22T06:17:07', 'closeTime': '2025-09-22T06:19:25', 'expiration': '1970-01-01T00:00:00', 'type': 'Buy', 'lots': 0.01, 'symbol': 'XAUUSD', 'openPrice': 3691.24, 'stopLoss': 0.0, 'takeProfit': 0.0, 'closePrice': 3689.84, 'magicNumber': 0, 'swap': 0.0, 'commission': 0.0, 'comment': '', 'profit': -1.4, 'rateOpen': 1.0, 'rateClose': 1.0, 'rateMargin': 1.0, 'ex': {'order': 86404876, 'login': 301390786, 'symbol': 'WEFVVVNEAAAAAAAA', 'digits': 2, 'cmd': 0, 'volume': 1, 'open_time': 1758521827, 'state': 3, 'open_price': 3691.24, 'sl': 0.0, 'tp': 0.0, 'close_time': 1758521965, 'value_date': 0, 'expiration': 0, 'place_type': 0, 'conv_rates': [1.0, 1.0], 'commission': 0.0, 'commission_agent': 0.0, 'storage': 0.0, 'close_price': 3689.84, 'profit': -1.4, 'taxes': 0.0, 'magic': 0, 'comment': '', 'internal_id': 0, 'activation': 0, 'spread': 0, 'margin_rate': 1.0, 'timestamp': 1758521965, 'reserved': [0, 0, 0, 0], 'next': 0}, 'placedType': 'Client', 'state': 'CLOSED_NORMAL', 'digits': 2}
INFO     - 2025-09-22 11:19:32 - [api_base:1363] - 校验通过: 预期：开仓订单号和平仓订单号一致

实际: 86404876
操作: ==
预期: 86404876

INFO     - 2025-09-22 11:19:32 - [test_oac_proportion:842] - 开仓订单号和平仓订单号一致,开仓订单号：86404876 平仓订单号：86404876
DEBUG    - 2025-09-22 11:19:32 - [connectionpool:546] - https://dev.lgcopytrade.top:443 "GET /api/online/cgreport/api/getColumnsAndData/1568899025974796289?_t=1758510943&pageNo=1&pageSize=50&self_master_ticket=86404876 HTTP/11" 200 None
INFO     - 2025-09-22 11:19:32 - [api_base:257] - [2025-09-22 11:19:32] GET请求: /online/cgreport/api/getColumnsAndData/1568899025974796289 | 参数: {'_t': 1758510943, 'pageNo': 1, 'pageSize': 50, 'self_master_ticket': 86404876}
INFO     - 2025-09-22 11:19:35 - [api_base:1363] - 校验通过: 第 1 条记录的订单号应为86404877

实际: 86404877
操作: ==
预期: 86404877

INFO     - 2025-09-22 11:19:35 - [api_base:1363] - 校验通过: 喊单者订单号符合预期

实际: 86404876
操作: ==
预期: 86404876

INFO     - 2025-09-22 11:19:35 - [test_oac_proportion:933] - 喊单者订单号验证通过: 86404876
INFO     - 2025-09-22 11:19:35 - [api_base:1363] - 校验通过: 喊单者手数符合预期

实际: 0.01
操作: ==
预期: 0.01

INFO     - 2025-09-22 11:19:35 - [test_oac_proportion:947] - 喊单者手数验证通过: 0.01
INFO     - 2025-09-22 11:19:35 - [api_base:1363] - 校验通过: 跟单手数符合预期

实际: 0.01
操作: ==
预期: 0.01

INFO     - 2025-09-22 11:19:35 - [test_oac_proportion:974] - 跟单手数验证通过: 0.01
INFO     - 2025-09-22 11:19:35 - [api_base:1363] - 校验通过: 交易币种符合预期

实际: XAUUSD
操作: ==
预期: XAUUSD

INFO     - 2025-09-22 11:19:35 - [test_oac_proportion:989] - 交易币种验证通过: XAUUSD
DEBUG    - 2025-09-22 11:19:36 - [connectionpool:546] - https://dev.lgcopytrade.top:443 "GET /api/online/cgform/api/getData/402883977b38c9ca017b38c9caff0000?_t=1758510943&trader_id=1969961827138736130&column=id&order=desc&pageNo=1&pageSize=50&superQueryMatchType=and HTTP/11" 200 None
INFO     - 2025-09-22 11:19:36 - [api_base:257] - [2025-09-22 11:19:36] GET请求: /online/cgform/api/getData/402883977b38c9ca017b38c9caff0000 | 参数: {'_t': 1758510943, 'trader_id': '1969961827138736130', 'column': 'id', 'order': 'desc', 'pageNo': 1, 'pageSize': 50, 'superQueryMatchType': 'and'}
INFO     - 2025-09-22 11:19:39 - [test_oac_proportion:1024] - 查询结果符合预期：records为空列表
DEBUG    - 2025-09-22 11:19:40 - [connectionpool:546] - https://dev.lgcopytrade.top:443 "GET /api/online/cgform/api/getData/402883977b38c9ca017b38c9caff0000?_t=1758510943&trader_id=1969961978502778881&column=id&order=desc&pageNo=1&pageSize=50&superQueryMatchType=and HTTP/11" 200 None
INFO     - 2025-09-22 11:19:40 - [api_base:257] - [2025-09-22 11:19:40] GET请求: /online/cgform/api/getData/402883977b38c9ca017b38c9caff0000 | 参数: {'_t': 1758510943, 'trader_id': '1969961978502778881', 'column': 'id', 'order': 'desc', 'pageNo': 1, 'pageSize': 50, 'superQueryMatchType': 'and'}
DEBUG    - 2025-09-22 11:20:03 - [connectionpool:546] - https://dev.lgcopytrade.top:443 "GET /api/online/cgform/api/getData/402883977b38c9ca017b38c9caff0000?_t=1758510943&trader_id=1969961978502778881&column=id&order=desc&pageNo=1&pageSize=50&superQueryMatchType=and HTTP/11" 200 None
INFO     - 2025-09-22 11:20:03 - [api_base:257] - [2025-09-22 11:20:03] GET请求: /online/cgform/api/getData/402883977b38c9ca017b38c9caff0000 | 参数: {'_t': 1758510943, 'trader_id': '1969961978502778881', 'column': 'id', 'order': 'desc', 'pageNo': 1, 'pageSize': 50, 'superQueryMatchType': 'and'}
DEBUG    - 2025-09-22 11:20:27 - [connectionpool:546] - https://dev.lgcopytrade.top:443 "GET /api/online/cgform/api/getData/402883977b38c9ca017b38c9caff0000?_t=1758510943&trader_id=1969961978502778881&column=id&order=desc&pageNo=1&pageSize=50&superQueryMatchType=and HTTP/11" 200 None
INFO     - 2025-09-22 11:20:27 - [api_base:257] - [2025-09-22 11:20:27] GET请求: /online/cgform/api/getData/402883977b38c9ca017b38c9caff0000 | 参数: {'_t': 1758510943, 'trader_id': '1969961978502778881', 'column': 'id', 'order': 'desc', 'pageNo': 1, 'pageSize': 50, 'superQueryMatchType': 'and'}
