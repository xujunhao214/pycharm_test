{"name": "数据库校验-云跟单账号策略平仓-修改币种p", "status": "failed", "statusDetails": {"message": "AssertionError: 修改币种下单总手数应该是0.02或者0.03，如果币种不在交易时间就是1，实际是：21.0\nassert (False or False or False)\n +  where False = <built-in function isclose>(21.0, 0.02, rel_tol=1e-09)\n +    where <built-in function isclose> = math.isclose\n +  and   False = <built-in function isclose>(21.0, 0.03, rel_tol=1e-09)\n +    where <built-in function isclose> = math.isclose\n +  and   False = <built-in function isclose>(21.0, 1.0, rel_tol=1e-09)\n +    where <built-in function isclose> = math.isclose", "trace": "self = <lingkuan_825.test_cloudTrader.test_cloudtrader_money_scene.Testcloudtrader_moneyandscene.Testcloudtrader_money object at 0x0000012EF6132D90>\nvar_manager = <lingkuan_825.commons.variable_manager.VariableManager object at 0x0000012EF7623640>\ndb_transaction = <pymysql.connections.Connection object at 0x0000012EF6322D90>\n\n    @allure.title(\"数据库校验-云跟单账号策略平仓-修改币种p\")\n    def test_dbclose_cfdp(self, var_manager, db_transaction):\n        with allure.step(\"1. 获取订单详情表账号数据\"):\n            cloudTrader_user_accounts_9 = var_manager.get_variable(\"cloudTrader_user_accounts_9\")\n            sql = f\"\"\"\n                    SELECT\n                        fod.size,\n                        fod.close_no,\n                        fod.symbol,\n                        fod.order_no,\n                        foi.true_total_lots,\n                        foi.order_no,\n                        foi.operation_type,\n                        foi.create_time,\n                        foi.status\n                    FROM\n                        follow_order_detail fod\n                    INNER JOIN\n                        follow_order_instruct foi\n                    ON\n                        foi.order_no = fod.close_no COLLATE utf8mb4_0900_ai_ci\n                    WHERE foi.operation_type=%s\n                        AND fod.account = %s\n                        \"\"\"\n            params = (\n                '1',\n                cloudTrader_user_accounts_9,\n            )\n    \n            # 调用轮询等待方法（带时间范围过滤）\n            db_data = self.query_database_with_time(\n                db_transaction=db_transaction,\n                sql=sql,\n                params=params,\n                time_field=\"foi.create_time\"\n            )\n    \n        with allure.step(\"2. 校验数据\"):\n            if not db_data:\n                pytest.fail(\"数据库查询结果为空，无法提取数据\")\n    \n            addsalve_size_cfdp_close = [record[\"size\"] for record in db_data]\n            var_manager.set_runtime_variable(\"addsalve_size_cfdp_close\", addsalve_size_cfdp_close)\n            addsalve_size_cfdp_total = sum(addsalve_size_cfdp_close)\n>           assert (math.isclose(addsalve_size_cfdp_total, 0.02, rel_tol=1e-9) or\n                    math.isclose(addsalve_size_cfdp_total, 0.03, rel_tol=1e-9) or\n                    math.isclose(addsalve_size_cfdp_total, 1.0,\n                                 rel_tol=1e-9)), f\"修改币种下单总手数应该是0.02或者0.03，如果币种不在交易时间就是1，实际是：{addsalve_size_cfdp_total}\"\nE           AssertionError: 修改币种下单总手数应该是0.02或者0.03，如果币种不在交易时间就是1，实际是：21.0\nE           assert (False or False or False)\nE            +  where False = <built-in function isclose>(21.0, 0.02, rel_tol=1e-09)\nE            +    where <built-in function isclose> = math.isclose\nE            +  and   False = <built-in function isclose>(21.0, 0.03, rel_tol=1e-09)\nE            +    where <built-in function isclose> = math.isclose\nE            +  and   False = <built-in function isclose>(21.0, 1.0, rel_tol=1e-09)\nE            +    where <built-in function isclose> = math.isclose\n\ntest_cloudTrader\\test_cloudtrader_money_scene.py:458: AssertionError"}, "description": "\n    ### 用例说明\n    - 前置条件：有云策略和云跟单\n    - 操作步骤：\n      1. 有三个账号，分别修改三个账号的后缀.@ .p .min\n      2. 进行开仓\n      3. 判断三个账号的币种手数是否正确\n      4. 进行平仓\n      5. 判断三个账号的币种手数是否正确\n    - 预期结果：三个账号的币种手数正确\n    ", "steps": [{"name": "1. 获取订单详情表账号数据", "status": "passed", "steps": [{"name": "轮询等待数据稳定（超时: 30秒，稳定期: 2秒）", "status": "passed", "steps": [{"name": "执行单次数据库查询", "status": "passed", "steps": [{"name": "执行数据库查询", "status": "passed", "attachments": [{"name": "执行SQL", "source": "c720274e-16f4-4fd5-ae2b-eb5fcd77a55a-attachment.txt", "type": "text/plain"}, {"name": "SQL参数", "source": "17b2ce0d-9bcd-4528-9f49-4c9c85a6d9e0-attachment.txt", "type": "text/plain"}], "start": 1756432795449, "stop": 1756432796388}], "attachments": [{"name": "查询条件", "source": "af7ce665-6c79-49fa-8e58-1ecd085f46e6-attachment.txt", "type": "text/plain"}], "start": 1756432795449, "stop": 1756432796388}, {"name": "轮询中（已等待1.0秒）", "status": "passed", "attachments": [{"name": "当前状态", "source": "62c94c76-0c52-48fd-912b-1d2e90547781-attachment.txt", "type": "text/plain"}, {"name": "超时倒计时", "source": "6a9a2df6-bba0-4c00-a545-bd6ce545ef5f-attachment.txt", "type": "text/plain"}], "start": 1756432796388, "stop": 1756432796390}, {"name": "判断结果稳定性", "status": "passed", "attachments": [{"name": "判断结果", "source": "1ce9992c-14da-4558-b72e-a7935603e4c9-attachment.txt", "type": "text/plain"}], "start": 1756432796390, "stop": 1756432796391}, {"name": "数据发生变化", "status": "passed", "attachments": [{"name": "状态说明", "source": "79913231-9e7d-4e1b-a362-bfa3abbdb682-attachment.txt", "type": "text/plain"}], "start": 1756432796391, "stop": 1756432796392}, {"name": "执行单次数据库查询", "status": "passed", "steps": [{"name": "执行数据库查询", "status": "passed", "attachments": [{"name": "执行SQL", "source": "918d459d-3bf5-4d36-8d36-5ac8118c1649-attachment.txt", "type": "text/plain"}, {"name": "SQL参数", "source": "c40d93a5-1dd5-4ac7-97a7-4be949c4e3c0-attachment.txt", "type": "text/plain"}], "start": 1756432798441, "stop": 1756432799427}], "attachments": [{"name": "查询条件", "source": "935d1b5a-b699-45db-b391-f4f1a3ef6125-attachment.txt", "type": "text/plain"}], "start": 1756432798441, "stop": 1756432799427}, {"name": "轮询中（已等待4.0秒）", "status": "passed", "attachments": [{"name": "当前状态", "source": "178881d6-b9c2-49cf-b363-73f9a65040cf-attachment.txt", "type": "text/plain"}, {"name": "超时倒计时", "source": "bec1460d-895b-4ac3-b70a-6aede5380812-attachment.txt", "type": "text/plain"}], "start": 1756432799427, "stop": 1756432799428}, {"name": "判断结果稳定性", "status": "passed", "attachments": [{"name": "判断结果", "source": "386cd280-e079-49f7-b953-090e8cfa7c4d-attachment.txt", "type": "text/plain"}], "start": 1756432799428, "stop": 1756432799429}, {"name": "数据首次稳定", "status": "passed", "attachments": [{"name": "状态说明", "source": "b3de9ab3-9143-46a7-9355-d1d189427e5d-attachment.txt", "type": "text/plain"}], "start": 1756432799429, "stop": 1756432799429}, {"name": "执行单次数据库查询", "status": "passed", "steps": [{"name": "执行数据库查询", "status": "passed", "attachments": [{"name": "执行SQL", "source": "708073fb-3c6b-4072-8d57-4d359e69790a-attachment.txt", "type": "text/plain"}, {"name": "SQL参数", "source": "beb6b87f-ffc6-4b5a-bdb4-3e43ffce38b1-attachment.txt", "type": "text/plain"}], "start": 1756432801484, "stop": 1756432802437}], "attachments": [{"name": "查询条件", "source": "af92f8de-eac4-4a88-9529-f416a8226111-attachment.txt", "type": "text/plain"}], "start": 1756432801484, "stop": 1756432802437}, {"name": "轮询中（已等待7.0秒）", "status": "passed", "attachments": [{"name": "当前状态", "source": "5ccbf361-4048-487b-a402-07dc37b7a261-attachment.txt", "type": "text/plain"}, {"name": "超时倒计时", "source": "bcdd832b-33e7-41b0-9929-3abcd01c3475-attachment.txt", "type": "text/plain"}], "start": 1756432802437, "stop": 1756432802438}, {"name": "判断结果稳定性", "status": "passed", "attachments": [{"name": "判断结果", "source": "56a8f401-190d-437a-a4f5-aebfa3d971fb-attachment.txt", "type": "text/plain"}], "start": 1756432802438, "stop": 1756432802438}, {"name": "数据稳定达标", "status": "passed", "attachments": [{"name": "结果说明", "source": "c1355907-6f6b-4342-87fe-5b1b983e0e84-attachment.txt", "type": "text/plain"}], "start": 1756432802438, "stop": 1756432802438}, {"name": "数据库查询结果（最终稳定结果）", "status": "passed", "attachments": [{"name": "查询结果（共31条，显示前50条）", "source": "ab847890-ec2a-4d6c-a802-517c699e1549-attachment.json", "type": "application/json"}], "start": 1756432802438, "stop": 1756432802439}], "attachments": [{"name": "执行SQL", "source": "7fa76c7c-d795-4304-bc41-65a2e0cc2009-attachment.txt", "type": "text/plain"}, {"name": "SQL参数", "source": "30172870-bfcd-4286-ae6e-ca2dbdb578ec-attachment.txt", "type": "text/plain"}, {"name": "时间范围", "source": "26be3fc3-9e55-4d58-8102-59da86e177fe-attachment.txt", "type": "text/plain"}], "start": 1756432795400, "stop": 1756432802439}], "start": 1756432795400, "stop": 1756432802439}, {"name": "2. 校验数据", "status": "failed", "statusDetails": {"message": "AssertionError: 修改币种下单总手数应该是0.02或者0.03，如果币种不在交易时间就是1，实际是：21.0\nassert (False or False or False)\n +  where False = <built-in function isclose>(21.0, 0.02, rel_tol=1e-09)\n +    where <built-in function isclose> = math.isclose\n +  and   False = <built-in function isclose>(21.0, 0.03, rel_tol=1e-09)\n +    where <built-in function isclose> = math.isclose\n +  and   False = <built-in function isclose>(21.0, 1.0, rel_tol=1e-09)\n +    where <built-in function isclose> = math.isclose\n", "trace": "  File \"D:\\pycharm_test\\lingkuan_825\\test_cloudTrader\\test_cloudtrader_money_scene.py\", line 458, in test_dbclose_cfdp\n    assert (math.isclose(addsalve_size_cfdp_total, 0.02, rel_tol=1e-9) or\n"}, "start": 1756432802439, "stop": 1756432802440}], "attachments": [{"name": "log", "source": "2ab1944f-d6b2-4c0a-9825-0e505359854f-attachment.txt", "type": "text/plain"}], "start": 1756432795400, "stop": 1756432802440, "uuid": "cd408d4c-f816-46f1-ac88-3646bde53294", "historyId": "3c81c7e8d4325331f3ef0909166b72d7", "testCaseId": "3c81c7e8d4325331f3ef0909166b72d7", "fullName": "test_cloudTrader.test_cloudtrader_money_scene.Testcloudtrader_money#test_dbclose_cfdp", "labels": [{"name": "feature", "value": "云策略-云策略列表-修改跟单账号"}, {"name": "story", "value": "场景1：云策略-云策略列表-云跟单账号修改币种"}, {"name": "parentSuite", "value": "test_cloudTrader"}, {"name": "suite", "value": "test_cloudtrader_money_scene"}, {"name": "subSuite", "value": "Testcloudtrader_moneyandscene"}, {"name": "host", "value": "DESKTOP-4S9CU1E"}, {"name": "thread", "value": "21760-MainThread"}, {"name": "framework", "value": "pytest"}, {"name": "language", "value": "cpython3"}, {"name": "package", "value": "test_cloudTrader.test_cloudtrader_money_scene"}]}