{"name": "数据库校验-云跟单账号策略平仓-修改币种p", "status": "failed", "statusDetails": {"message": "AssertionError: 修改币种下单总手数应该是0.02或者0.03，如果币种不在交易时间就是1，实际是：21.0\nassert (False or False or False)\n +  where False = <built-in function isclose>(21.0, 0.02, rel_tol=1e-09)\n +    where <built-in function isclose> = math.isclose\n +  and   False = <built-in function isclose>(21.0, 0.03, rel_tol=1e-09)\n +    where <built-in function isclose> = math.isclose\n +  and   False = <built-in function isclose>(21.0, 1.0, rel_tol=1e-09)\n +    where <built-in function isclose> = math.isclose", "trace": "self = <lingkuan_825.test_cloudTrader.test_cloudtrader_money_scene.Testcloudtrader_moneyandscene.Testcloudtrader_money object at 0x0000012EF6132D90>\nvar_manager = <lingkuan_825.commons.variable_manager.VariableManager object at 0x0000012EF7623640>\ndb_transaction = <pymysql.connections.Connection object at 0x0000012EF7852A00>\n\n    @allure.title(\"数据库校验-云跟单账号策略平仓-修改币种p\")\n    def test_dbclose_cfdp(self, var_manager, db_transaction):\n        with allure.step(\"1. 获取订单详情表账号数据\"):\n            cloudTrader_user_accounts_9 = var_manager.get_variable(\"cloudTrader_user_accounts_9\")\n            sql = f\"\"\"\n                    SELECT\n                        fod.size,\n                        fod.close_no,\n                        fod.symbol,\n                        fod.order_no,\n                        foi.true_total_lots,\n                        foi.order_no,\n                        foi.operation_type,\n                        foi.create_time,\n                        foi.status\n                    FROM\n                        follow_order_detail fod\n                    INNER JOIN\n                        follow_order_instruct foi\n                    ON\n                        foi.order_no = fod.close_no COLLATE utf8mb4_0900_ai_ci\n                    WHERE foi.operation_type=%s\n                        AND fod.account = %s\n                        \"\"\"\n            params = (\n                '1',\n                cloudTrader_user_accounts_9,\n            )\n    \n            # 调用轮询等待方法（带时间范围过滤）\n            db_data = self.query_database_with_time(\n                db_transaction=db_transaction,\n                sql=sql,\n                params=params,\n                time_field=\"foi.create_time\"\n            )\n    \n        with allure.step(\"2. 校验数据\"):\n            if not db_data:\n                pytest.fail(\"数据库查询结果为空，无法提取数据\")\n    \n            addsalve_size_cfdp_close = [record[\"size\"] for record in db_data]\n            var_manager.set_runtime_variable(\"addsalve_size_cfdp_close\", addsalve_size_cfdp_close)\n            addsalve_size_cfdp_total = sum(addsalve_size_cfdp_close)\n>           assert (math.isclose(addsalve_size_cfdp_total, 0.02, rel_tol=1e-9) or\n                    math.isclose(addsalve_size_cfdp_total, 0.03, rel_tol=1e-9) or\n                    math.isclose(addsalve_size_cfdp_total, 1.0,\n                                 rel_tol=1e-9)), f\"修改币种下单总手数应该是0.02或者0.03，如果币种不在交易时间就是1，实际是：{addsalve_size_cfdp_total}\"\nE           AssertionError: 修改币种下单总手数应该是0.02或者0.03，如果币种不在交易时间就是1，实际是：21.0\nE           assert (False or False or False)\nE            +  where False = <built-in function isclose>(21.0, 0.02, rel_tol=1e-09)\nE            +    where <built-in function isclose> = math.isclose\nE            +  and   False = <built-in function isclose>(21.0, 0.03, rel_tol=1e-09)\nE            +    where <built-in function isclose> = math.isclose\nE            +  and   False = <built-in function isclose>(21.0, 1.0, rel_tol=1e-09)\nE            +    where <built-in function isclose> = math.isclose\n\ntest_cloudTrader\\test_cloudtrader_money_scene.py:458: AssertionError"}, "description": "\n    ### 用例说明\n    - 前置条件：有云策略和云跟单\n    - 操作步骤：\n      1. 有三个账号，分别修改三个账号的后缀.@ .p .min\n      2. 进行开仓\n      3. 判断三个账号的币种手数是否正确\n      4. 进行平仓\n      5. 判断三个账号的币种手数是否正确\n    - 预期结果：三个账号的币种手数正确\n    ", "steps": [{"name": "1. 获取订单详情表账号数据", "status": "passed", "steps": [{"name": "轮询等待数据稳定（超时: 30秒，稳定期: 2秒）", "status": "passed", "steps": [{"name": "执行单次数据库查询", "status": "passed", "steps": [{"name": "执行数据库查询", "status": "passed", "attachments": [{"name": "执行SQL", "source": "7fc52a64-85f4-4be2-89a4-68c598176d49-attachment.txt", "type": "text/plain"}, {"name": "SQL参数", "source": "f5d7038d-dfc3-4292-9900-7be9413a871f-attachment.txt", "type": "text/plain"}], "start": 1756432782970, "stop": 1756432783910}], "attachments": [{"name": "查询条件", "source": "8b39cb03-bf45-4f94-9832-79eeb31a6471-attachment.txt", "type": "text/plain"}], "start": 1756432782969, "stop": 1756432783910}, {"name": "轮询中（已等待1.0秒）", "status": "passed", "attachments": [{"name": "当前状态", "source": "85911d83-978c-4a53-b0d2-b7b3bbd0e86b-attachment.txt", "type": "text/plain"}, {"name": "超时倒计时", "source": "e4e5ef8f-90d7-4309-84ef-2400689524c9-attachment.txt", "type": "text/plain"}], "start": 1756432783910, "stop": 1756432783912}, {"name": "判断结果稳定性", "status": "passed", "attachments": [{"name": "判断结果", "source": "ff6c2f3e-d921-427e-a5be-5b4478efa22a-attachment.txt", "type": "text/plain"}], "start": 1756432783912, "stop": 1756432783913}, {"name": "数据发生变化", "status": "passed", "attachments": [{"name": "状态说明", "source": "5a1960dd-58a4-4a19-aff5-aa5933ec5ed6-attachment.txt", "type": "text/plain"}], "start": 1756432783913, "stop": 1756432783914}, {"name": "执行单次数据库查询", "status": "passed", "steps": [{"name": "执行数据库查询", "status": "passed", "attachments": [{"name": "执行SQL", "source": "e7f0f500-b0d7-4d49-9575-0eac86202c5a-attachment.txt", "type": "text/plain"}, {"name": "SQL参数", "source": "83091f77-fdc7-4ee0-9e51-8ee0b8bc575d-attachment.txt", "type": "text/plain"}], "start": 1756432785964, "stop": 1756432786949}], "attachments": [{"name": "查询条件", "source": "46fd4049-dd00-4d8e-9c48-7253327c06e3-attachment.txt", "type": "text/plain"}], "start": 1756432785964, "stop": 1756432786949}, {"name": "轮询中（已等待4.0秒）", "status": "passed", "attachments": [{"name": "当前状态", "source": "d24ad836-7310-45a3-a097-106d4ff0934b-attachment.txt", "type": "text/plain"}, {"name": "超时倒计时", "source": "4ff8a882-34d7-45a0-8bac-d3c1ddaab3e0-attachment.txt", "type": "text/plain"}], "start": 1756432786949, "stop": 1756432786951}, {"name": "判断结果稳定性", "status": "passed", "attachments": [{"name": "判断结果", "source": "7f473d01-0489-4230-bef2-1eee4e24f5e7-attachment.txt", "type": "text/plain"}], "start": 1756432786951, "stop": 1756432786953}, {"name": "数据首次稳定", "status": "passed", "attachments": [{"name": "状态说明", "source": "8e5a5f0e-c645-4329-8b7d-083de35faa56-attachment.txt", "type": "text/plain"}], "start": 1756432786953, "stop": 1756432786953}, {"name": "执行单次数据库查询", "status": "passed", "steps": [{"name": "执行数据库查询", "status": "passed", "attachments": [{"name": "执行SQL", "source": "fb4d07ae-aac7-416c-b849-55fd2f537ade-attachment.txt", "type": "text/plain"}, {"name": "SQL参数", "source": "4b4a8541-aaeb-4c90-ac5d-d4beac8ef39c-attachment.txt", "type": "text/plain"}], "start": 1756432789003, "stop": 1756432789934}], "attachments": [{"name": "查询条件", "source": "23dbc678-9222-48fa-adb3-7d9a7d6d084f-attachment.txt", "type": "text/plain"}], "start": 1756432789003, "stop": 1756432789934}, {"name": "轮询中（已等待7.0秒）", "status": "passed", "attachments": [{"name": "当前状态", "source": "8d28cb8d-823c-4e54-b98a-9624b3777c43-attachment.txt", "type": "text/plain"}, {"name": "超时倒计时", "source": "76a593ed-eeba-40bf-bb9c-57f8daa396a5-attachment.txt", "type": "text/plain"}], "start": 1756432789934, "stop": 1756432789936}, {"name": "判断结果稳定性", "status": "passed", "attachments": [{"name": "判断结果", "source": "d689c334-7c62-4929-b97b-8648899f3f0e-attachment.txt", "type": "text/plain"}], "start": 1756432789936, "stop": 1756432789936}, {"name": "数据稳定达标", "status": "passed", "attachments": [{"name": "结果说明", "source": "2a995d9a-5971-400b-89c0-adf81dada46a-attachment.txt", "type": "text/plain"}], "start": 1756432789936, "stop": 1756432789937}, {"name": "数据库查询结果（最终稳定结果）", "status": "passed", "attachments": [{"name": "查询结果（共31条，显示前50条）", "source": "21b7ee58-febe-4b64-acab-e6cda628a2af-attachment.json", "type": "application/json"}], "start": 1756432789937, "stop": 1756432789937}], "attachments": [{"name": "执行SQL", "source": "30477038-fcdb-4717-b7c0-fcb90f80eafd-attachment.txt", "type": "text/plain"}, {"name": "SQL参数", "source": "d78db96c-61f1-48be-82aa-e033cdae64ee-attachment.txt", "type": "text/plain"}, {"name": "时间范围", "source": "c9076260-e594-4345-84f3-c04e6c52dfd2-attachment.txt", "type": "text/plain"}], "start": 1756432782922, "stop": 1756432789937}], "start": 1756432782921, "stop": 1756432789937}, {"name": "2. 校验数据", "status": "failed", "statusDetails": {"message": "AssertionError: 修改币种下单总手数应该是0.02或者0.03，如果币种不在交易时间就是1，实际是：21.0\nassert (False or False or False)\n +  where False = <built-in function isclose>(21.0, 0.02, rel_tol=1e-09)\n +    where <built-in function isclose> = math.isclose\n +  and   False = <built-in function isclose>(21.0, 0.03, rel_tol=1e-09)\n +    where <built-in function isclose> = math.isclose\n +  and   False = <built-in function isclose>(21.0, 1.0, rel_tol=1e-09)\n +    where <built-in function isclose> = math.isclose\n", "trace": "  File \"D:\\pycharm_test\\lingkuan_825\\test_cloudTrader\\test_cloudtrader_money_scene.py\", line 458, in test_dbclose_cfdp\n    assert (math.isclose(addsalve_size_cfdp_total, 0.02, rel_tol=1e-9) or\n"}, "start": 1756432789937, "stop": 1756432789938}], "attachments": [{"name": "log", "source": "cc2ec168-6e81-4a86-91d7-03424f26baae-attachment.txt", "type": "text/plain"}], "start": 1756432782921, "stop": 1756432789938, "uuid": "34fe3c40-f0b9-49eb-9963-d3fc03b0ace5", "historyId": "3c81c7e8d4325331f3ef0909166b72d7", "testCaseId": "3c81c7e8d4325331f3ef0909166b72d7", "fullName": "test_cloudTrader.test_cloudtrader_money_scene.Testcloudtrader_money#test_dbclose_cfdp", "labels": [{"name": "feature", "value": "云策略-云策略列表-修改跟单账号"}, {"name": "story", "value": "场景1：云策略-云策略列表-云跟单账号修改币种"}, {"name": "parentSuite", "value": "test_cloudTrader"}, {"name": "suite", "value": "test_cloudtrader_money_scene"}, {"name": "subSuite", "value": "Testcloudtrader_moneyandscene"}, {"name": "host", "value": "DESKTOP-4S9CU1E"}, {"name": "thread", "value": "21760-MainThread"}, {"name": "framework", "value": "pytest"}, {"name": "language", "value": "cpython3"}, {"name": "package", "value": "test_cloudTrader.test_cloudtrader_money_scene"}]}