{"name": "数据库校验-账号管理-交易下单-根据remark发现有漏单", "status": "failed", "statusDetails": {"message": "AssertionError: 跟单失败，异常提示信息是：未开通下单状态，实际是：None\nassert None == '未开通下单状态'", "trace": "self = <lingkuanMT5_1029.test_cloudTrader.test_cloudOrder_open_level.TestMT5cloudTrader_openandlevel.Testcloudstargy_addstatus object at 0x0000015CAA9EF760>\nclass_random_str = 'gxlf9642'\nvar_manager = <lingkuanMT5_1029.commons.variable_manager.VariableManager object at 0x0000015CAAAF97C0>\ndb_transaction = <pymysql.connections.Connection object at 0x0000015CAAA11340>\n\n    @allure.title(\"数据库校验-账号管理-交易下单-根据remark发现有漏单\")\n    def test_dbquery_orderSend_addsalve(self, class_random_str, var_manager, db_transaction):\n        with allure.step(\"1. 查询数据库验证是否有跟单开仓指令\"):\n            MT5cloudTrader_user_accounts_2 = var_manager.get_variable(\"MT5cloudTrader_user_accounts_2\")\n    \n            sql = f\"\"\"\n                SELECT\n                    fod.send_no,\n                    fod.comment,\n                    fod.magical,\n                    fod.remark,\n                    fod.symbol,\n                    fod.order_no,\n                    foi.true_total_lots,\n                    foi.order_no,\n                    foi.operation_type,\n                    foi.create_time,\n                    foi.status,\n                    foi.master_order,\n                    foi.cloud_account,\n                    foi.total_orders\n                FROM\n                    follow_order_detail fod\n                INNER JOIN\n                    follow_order_instruct foi\n                ON\n                    foi.order_no = fod.send_no COLLATE utf8mb4_0900_ai_ci\n                WHERE foi.operation_type = %s\n                    AND foi.cloud_account = %s\n             \"\"\"\n            params = (\n                '0',\n                MT5cloudTrader_user_accounts_2,\n            )\n    \n            # 调用轮询等待方法（带时间范围过滤）\n            db_data = self.query_database_with_time(\n                db_transaction=db_transaction,\n                sql=sql,\n                params=params,\n                time_field=\"foi.create_time\"\n            )\n        with allure.step(\"2. 对订单状态进行校验\"):\n            if not db_data:\n                pytest.fail(\"数据库查询结果为空，无法提取数据\")\n            remark = db_data[0][\"remark\"]\n>           assert remark == \"未开通下单状态\", f\"跟单失败，异常提示信息是：未开通下单状态，实际是：{remark}\"\nE           AssertionError: 跟单失败，异常提示信息是：未开通下单状态，实际是：None\nE           assert None == '未开通下单状态'\n\ntest_cloudTrader\\test_cloudOrder_open_level.py:1266: AssertionError"}, "description": "\n    ### 用例说明\n    - 前置条件：有云策略和云跟单\n    - 操作步骤：\n      1. 修改云策略账号 策略状态为关闭\n      2. 进行开仓\n      3. 跟单账号跟单失败，有漏单数据，把redis数据和MySQL数据进行校验\n      4. 修改云策略 策略状态为开启\n      5. 进行补单操作，然后平仓\n    - 预期结果：云策略 策略状态为关闭，有漏单数据\n    ", "steps": [{"name": "1. 查询数据库验证是否有跟单开仓指令", "status": "passed", "steps": [{"name": "轮询等待数据稳定（超时: 30秒，稳定期: 2秒）", "status": "passed", "steps": [{"name": "执行单次数据库查询", "status": "passed", "steps": [{"name": "执行数据库查询", "status": "passed", "attachments": [{"name": "执行SQL", "source": "7e5fb3ef-a810-4af3-8419-7770a489cc63-attachment.txt", "type": "text/plain"}, {"name": "SQL参数", "source": "279a8705-8530-4017-963b-c147cd649337-attachment.txt", "type": "text/plain"}], "start": 1761729650048, "stop": 1761729651117}], "attachments": [{"name": "查询条件", "source": "d7e4de32-008c-431f-a228-9544d169e7ba-attachment.txt", "type": "text/plain"}], "start": 1761729650048, "stop": 1761729651117}, {"name": "轮询中（已等待1.1秒）", "status": "passed", "attachments": [{"name": "当前状态", "source": "c7803849-2472-4475-9068-e9a64e65acac-attachment.txt", "type": "text/plain"}, {"name": "超时倒计时", "source": "b0a8320a-2232-40cd-8b81-74021c599c10-attachment.txt", "type": "text/plain"}], "start": 1761729651117, "stop": 1761729651118}, {"name": "判断结果稳定性", "status": "passed", "attachments": [{"name": "判断结果", "source": "879f5d3e-688a-4280-8296-a455e2733db8-attachment.txt", "type": "text/plain"}], "start": 1761729651118, "stop": 1761729651118}, {"name": "数据发生变化", "status": "passed", "attachments": [{"name": "状态说明", "source": "0c94e2d9-c6f7-4d73-9d72-099eb321f3ca-attachment.txt", "type": "text/plain"}], "start": 1761729651118, "stop": 1761729651118}, {"name": "执行单次数据库查询", "status": "passed", "steps": [{"name": "执行数据库查询", "status": "passed", "attachments": [{"name": "执行SQL", "source": "b6cd7a89-5c61-4eb1-a38d-ced55c753360-attachment.txt", "type": "text/plain"}, {"name": "SQL参数", "source": "a6433a04-40fb-4622-9c78-19473b403b10-attachment.txt", "type": "text/plain"}], "start": 1761729653176, "stop": 1761729654197}], "attachments": [{"name": "查询条件", "source": "b01c9d7a-a2a8-49c5-9a72-2793bdf3980f-attachment.txt", "type": "text/plain"}], "start": 1761729653175, "stop": 1761729654197}, {"name": "轮询中（已等待4.2秒）", "status": "passed", "attachments": [{"name": "当前状态", "source": "40421313-58b3-4ebc-a725-04ef72cac3b8-attachment.txt", "type": "text/plain"}, {"name": "超时倒计时", "source": "656531ad-4c41-430d-8874-7193d85e933f-attachment.txt", "type": "text/plain"}], "start": 1761729654197, "stop": 1761729654198}, {"name": "判断结果稳定性", "status": "passed", "attachments": [{"name": "唯一键信息", "source": "b82a77e3-7062-46aa-9eca-6c564dd4810a-attachment.txt", "type": "text/plain"}, {"name": "判断结果", "source": "6706bcf7-e6c4-4c57-970d-ed4ccebdcccc-attachment.txt", "type": "text/plain"}], "start": 1761729654198, "stop": 1761729654198}, {"name": "数据首次稳定", "status": "passed", "attachments": [{"name": "状态说明", "source": "7811d1f4-098a-416f-8980-e17b7206346e-attachment.txt", "type": "text/plain"}], "start": 1761729654198, "stop": 1761729654198}, {"name": "执行单次数据库查询", "status": "passed", "steps": [{"name": "执行数据库查询", "status": "passed", "attachments": [{"name": "执行SQL", "source": "0227433d-e912-4b6b-994a-d44ebfaf899c-attachment.txt", "type": "text/plain"}, {"name": "SQL参数", "source": "25c31407-ab74-4415-adbd-0e92ad37dc05-attachment.txt", "type": "text/plain"}], "start": 1761729656260, "stop": 1761729657321}], "attachments": [{"name": "查询条件", "source": "95ec80e2-ac81-4a36-b756-c675ab5664cf-attachment.txt", "type": "text/plain"}], "start": 1761729656259, "stop": 1761729657321}, {"name": "轮询中（已等待7.3秒）", "status": "passed", "attachments": [{"name": "当前状态", "source": "453c9902-e96d-4694-9d46-fda5e9def46d-attachment.txt", "type": "text/plain"}, {"name": "超时倒计时", "source": "aea08996-fb73-455d-8196-05d53eaf2dd0-attachment.txt", "type": "text/plain"}], "start": 1761729657321, "stop": 1761729657322}, {"name": "判断结果稳定性", "status": "passed", "attachments": [{"name": "唯一键信息", "source": "42076b2c-2bde-4c11-8aba-f797cd7b8773-attachment.txt", "type": "text/plain"}, {"name": "判断结果", "source": "5288e9ad-f3c0-49e2-9774-41d42e4af503-attachment.txt", "type": "text/plain"}], "start": 1761729657322, "stop": 1761729657322}, {"name": "数据发生变化", "status": "passed", "attachments": [{"name": "状态说明", "source": "fa922a94-16ce-43f8-ac09-8f12fb5bee56-attachment.txt", "type": "text/plain"}], "start": 1761729657322, "stop": 1761729657323}, {"name": "执行单次数据库查询", "status": "passed", "steps": [{"name": "执行数据库查询", "status": "passed", "attachments": [{"name": "执行SQL", "source": "df909d42-eeba-4872-9a5a-3515a945073d-attachment.txt", "type": "text/plain"}, {"name": "SQL参数", "source": "986c2443-e51c-4da8-b470-61fb7ee6372e-attachment.txt", "type": "text/plain"}], "start": 1761729659378, "stop": 1761729660412}], "attachments": [{"name": "查询条件", "source": "357d5a71-6ae1-494d-97cf-ce4febfd807d-attachment.txt", "type": "text/plain"}], "start": 1761729659378, "stop": 1761729660412}, {"name": "轮询中（已等待10.4秒）", "status": "passed", "attachments": [{"name": "当前状态", "source": "a58c2a20-0ded-497c-8567-b3f4595ce10a-attachment.txt", "type": "text/plain"}, {"name": "超时倒计时", "source": "79936201-34b9-4822-804f-e9ea14c9eb9f-attachment.txt", "type": "text/plain"}], "start": 1761729660412, "stop": 1761729660413}, {"name": "判断结果稳定性", "status": "passed", "attachments": [{"name": "唯一键信息", "source": "1ca5fb82-3de1-447c-85c0-544afa4b003a-attachment.txt", "type": "text/plain"}, {"name": "判断结果", "source": "108c4f0f-2aac-47ad-aacd-55c998132598-attachment.txt", "type": "text/plain"}], "start": 1761729660413, "stop": 1761729660414}, {"name": "数据首次稳定", "status": "passed", "attachments": [{"name": "状态说明", "source": "b495b581-4c31-4493-8060-0e4be3bcc0b7-attachment.txt", "type": "text/plain"}], "start": 1761729660414, "stop": 1761729660414}, {"name": "执行单次数据库查询", "status": "passed", "steps": [{"name": "执行数据库查询", "status": "passed", "attachments": [{"name": "执行SQL", "source": "c0eb1d9f-2027-4366-89d0-50f438af057b-attachment.txt", "type": "text/plain"}, {"name": "SQL参数", "source": "8955ebb6-2bf6-482e-963d-99d1a6da9be7-attachment.txt", "type": "text/plain"}], "start": 1761729662466, "stop": 1761729663482}], "attachments": [{"name": "查询条件", "source": "ac794ffe-b5c4-4052-b97e-55c3a73a9639-attachment.txt", "type": "text/plain"}], "start": 1761729662465, "stop": 1761729663482}, {"name": "轮询中（已等待13.5秒）", "status": "passed", "attachments": [{"name": "当前状态", "source": "2ef65321-4c38-4747-b296-a0d6b42d715d-attachment.txt", "type": "text/plain"}, {"name": "超时倒计时", "source": "69b3fbdd-3ea6-47a0-b727-9808f0319f17-attachment.txt", "type": "text/plain"}], "start": 1761729663482, "stop": 1761729663483}, {"name": "判断结果稳定性", "status": "passed", "attachments": [{"name": "唯一键信息", "source": "f8fa8d1f-dd7d-48d1-aede-6626a894cdda-attachment.txt", "type": "text/plain"}, {"name": "判断结果", "source": "0deb5654-f31b-4e84-bfc0-042e1bc87f71-attachment.txt", "type": "text/plain"}], "start": 1761729663483, "stop": 1761729663484}, {"name": "数据稳定达标", "status": "passed", "attachments": [{"name": "结果说明", "source": "8d0edcce-d60c-4cb0-8fa0-640560565844-attachment.txt", "type": "text/plain"}], "start": 1761729663484, "stop": 1761729663484}, {"name": "数据库查询结果（最终稳定结果）", "status": "passed", "attachments": [{"name": "查询结果（共3条，显示前50条）", "source": "1b668d86-57db-4851-b9eb-4b2374f577e8-attachment.json", "type": "application/json"}, {"name": "执行SQL", "source": "683fa23e-7baa-4f21-9672-db46cb61aa2a-attachment.txt", "type": "text/plain"}, {"name": "SQL参数", "source": "7030f676-cfca-470b-a11a-295a83e32050-attachment.txt", "type": "text/plain"}, {"name": "查询时间窗口", "source": "893bff36-8f04-4576-81d4-08da868c5065-attachment.txt", "type": "text/plain"}], "start": 1761729663484, "stop": 1761729663485}], "start": 1761729650001, "stop": 1761729663485}], "start": 1761729650001, "stop": 1761729663485}, {"name": "2. 对订单状态进行校验", "status": "failed", "statusDetails": {"message": "AssertionError: 跟单失败，异常提示信息是：未开通下单状态，实际是：None\nassert None == '未开通下单状态'\n", "trace": "  File \"D:\\pycharm_test\\lingkuanMT5_1029\\test_cloudTrader\\test_cloudOrder_open_level.py\", line 1266, in test_dbquery_orderSend_addsalve\n    assert remark == \"未开通下单状态\", f\"跟单失败，异常提示信息是：未开通下单状态，实际是：{remark}\"\n"}, "start": 1761729663485, "stop": 1761729663486}], "attachments": [{"name": "log", "source": "8d162402-1557-495e-abf7-c3fe17605197-attachment.txt", "type": "text/plain"}], "start": 1761729650001, "stop": 1761729663486, "uuid": "1b60229f-b24b-4a86-9ee6-7388c2451775", "historyId": "c72488f9e83a981e6e7d48ee2fd8d6ca", "testCaseId": "c72488f9e83a981e6e7d48ee2fd8d6ca", "fullName": "test_cloudTrader.test_cloudOrder_open_level.Testcloudstargy_addstatus#test_dbquery_orderSend_addsalve", "labels": [{"name": "feature", "value": "云策略-策略账号交易下单-漏单场景"}, {"name": "story", "value": "场景3：交易下单-云策略复制下单-策略账号-策略状态关闭"}, {"name": "parentSuite", "value": "test_cloudTrader"}, {"name": "suite", "value": "test_cloudOrder_open_level"}, {"name": "subSuite", "value": "TestMT5cloudTrader_openandlevel"}, {"name": "host", "value": "DESKTOP-4S9CU1E"}, {"name": "thread", "value": "80940-MainThread"}, {"name": "framework", "value": "pytest"}, {"name": "language", "value": "cpython3"}, {"name": "package", "value": "test_cloudTrader.test_cloudOrder_open_level"}]}