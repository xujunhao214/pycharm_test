{"name": "数据库校验-账号管理-交易下单-根据remark发现有漏单", "status": "failed", "statusDetails": {"message": "AssertionError: 跟单失败，异常提示信息是：未开通下单状态，实际是：None\nassert None == '未开通下单状态'", "trace": "self = <lingkuanMT5_1029.test_cloudTrader.test_cloudOrder_open_level.TestMT5cloudTrader_openandlevel.Testcloudstargy_status object at 0x0000015CAAAAD8B0>\nclass_random_str = 'xrxa9714'\nvar_manager = <lingkuanMT5_1029.commons.variable_manager.VariableManager object at 0x0000015CAAAF97C0>\ndb_transaction = <pymysql.connections.Connection object at 0x0000015CAACF5F40>\n\n    @allure.title(\"数据库校验-账号管理-交易下单-根据remark发现有漏单\")\n    def test_dbquery_orderSend_addsalve(self, class_random_str, var_manager, db_transaction):\n        with allure.step(\"1. 查询数据库验证是否有跟单开仓指令\"):\n            MT5cloudTrader_user_accounts_2 = var_manager.get_variable(\"MT5cloudTrader_user_accounts_2\")\n    \n            sql = f\"\"\"\n                SELECT\n                    fod.send_no,\n                    fod.comment,\n                    fod.magical,\n                    fod.remark,\n                    fod.symbol,\n                    fod.order_no,\n                    foi.true_total_lots,\n                    foi.order_no,\n                    foi.operation_type,\n                    foi.create_time,\n                    foi.status,\n                    foi.master_order,\n                    foi.cloud_account,\n                    foi.total_orders\n                FROM\n                    follow_order_detail fod\n                INNER JOIN\n                    follow_order_instruct foi\n                ON\n                    foi.order_no = fod.send_no COLLATE utf8mb4_0900_ai_ci\n                WHERE foi.operation_type = %s\n                    AND foi.cloud_account = %s\n                  \"\"\"\n            params = (\n                '0',\n                MT5cloudTrader_user_accounts_2,\n            )\n    \n            # 调用轮询等待方法（带时间范围过滤）\n            db_data = self.query_database_with_time(\n                db_transaction=db_transaction,\n                sql=sql,\n                params=params,\n                time_field=\"foi.create_time\"\n            )\n        with allure.step(\"2. 对订单状态进行校验\"):\n            if not db_data:\n                pytest.fail(\"数据库查询结果为空，无法提取数据\")\n            remark = db_data[0][\"remark\"]\n>           assert remark == \"未开通下单状态\", f\"跟单失败，异常提示信息是：未开通下单状态，实际是：{remark}\"\nE           AssertionError: 跟单失败，异常提示信息是：未开通下单状态，实际是：None\nE           assert None == '未开通下单状态'\n\ntest_cloudTrader\\test_cloudOrder_open_level.py:1759: AssertionError"}, "description": "\n    ### 用例说明\n    - 前置条件：有云策略和云跟单\n    - 操作步骤：\n      1. 修改云策略 策略状态为关闭\n      2. 进行开仓\n      3. 跟单账号跟单失败，有漏单数据，把redis数据和MySQL数据进行校验\n      4. 修改云策略 策略状态为开启\n      5. 进行补单操作，然后平仓\n    - 预期结果：云策略 策略状态为关闭，有漏单数据\n    ", "steps": [{"name": "1. 查询数据库验证是否有跟单开仓指令", "status": "passed", "steps": [{"name": "轮询等待数据稳定（超时: 30秒，稳定期: 2秒）", "status": "passed", "steps": [{"name": "执行单次数据库查询", "status": "passed", "steps": [{"name": "执行数据库查询", "status": "passed", "attachments": [{"name": "执行SQL", "source": "4a429835-8d00-44f4-89b0-1b055adeefc8-attachment.txt", "type": "text/plain"}, {"name": "SQL参数", "source": "ad32d629-65dd-4ded-b7ad-91aa8e1e5ef2-attachment.txt", "type": "text/plain"}], "start": 1761729721829, "stop": 1761729723035}], "attachments": [{"name": "查询条件", "source": "32115e6e-10ff-4342-a98c-d45b4e590fce-attachment.txt", "type": "text/plain"}], "start": 1761729721828, "stop": 1761729723035}, {"name": "轮询中（已等待1.3秒）", "status": "passed", "attachments": [{"name": "当前状态", "source": "9fdb46ba-b5c7-41a1-9fcf-32a9c23c8a24-attachment.txt", "type": "text/plain"}, {"name": "超时倒计时", "source": "cd9d63ca-6b14-48a2-b268-6e331c3f4eda-attachment.txt", "type": "text/plain"}], "start": 1761729723035, "stop": 1761729723036}, {"name": "判断结果稳定性", "status": "passed", "attachments": [{"name": "判断结果", "source": "f78c6678-5515-4ee4-aea1-7a5eb7575c00-attachment.txt", "type": "text/plain"}], "start": 1761729723036, "stop": 1761729723036}, {"name": "数据发生变化", "status": "passed", "attachments": [{"name": "状态说明", "source": "57b683e5-6902-4fce-ba32-9aa20ba469c0-attachment.txt", "type": "text/plain"}], "start": 1761729723036, "stop": 1761729723036}, {"name": "执行单次数据库查询", "status": "passed", "steps": [{"name": "执行数据库查询", "status": "passed", "attachments": [{"name": "执行SQL", "source": "168801aa-c30b-41db-bd51-05476c95eafd-attachment.txt", "type": "text/plain"}, {"name": "SQL参数", "source": "dc8b5107-7981-415d-82fb-caa968e29050-attachment.txt", "type": "text/plain"}], "start": 1761729725100, "stop": 1761729726160}], "attachments": [{"name": "查询条件", "source": "10695bda-6ced-4d90-9a93-f1b4ae6d8004-attachment.txt", "type": "text/plain"}], "start": 1761729725100, "stop": 1761729726160}, {"name": "轮询中（已等待4.4秒）", "status": "passed", "attachments": [{"name": "当前状态", "source": "d96451e2-092d-4fbd-a852-4623adc0ac5d-attachment.txt", "type": "text/plain"}, {"name": "超时倒计时", "source": "0efd8e01-eb50-4d09-8fca-1358823b59f3-attachment.txt", "type": "text/plain"}], "start": 1761729726160, "stop": 1761729726162}, {"name": "判断结果稳定性", "status": "passed", "attachments": [{"name": "唯一键信息", "source": "906742a8-9d4a-411d-9cfe-ea62bb0df898-attachment.txt", "type": "text/plain"}, {"name": "判断结果", "source": "531bf41d-58ca-4b8f-a636-1ee6a2e35a89-attachment.txt", "type": "text/plain"}], "start": 1761729726162, "stop": 1761729726163}, {"name": "数据首次稳定", "status": "passed", "attachments": [{"name": "状态说明", "source": "dbc07109-01a7-468f-8789-105913fe20ef-attachment.txt", "type": "text/plain"}], "start": 1761729726163, "stop": 1761729726163}, {"name": "执行单次数据库查询", "status": "passed", "steps": [{"name": "执行数据库查询", "status": "passed", "attachments": [{"name": "执行SQL", "source": "6e5bd1c0-0d0c-490c-ac93-d9cb06df0ca6-attachment.txt", "type": "text/plain"}, {"name": "SQL参数", "source": "c2dc0f8e-68ca-420f-a23f-515774c19f4a-attachment.txt", "type": "text/plain"}], "start": 1761729728213, "stop": 1761729729262}], "attachments": [{"name": "查询条件", "source": "900f1c06-46b0-4147-a0ba-99268e1dc6fb-attachment.txt", "type": "text/plain"}], "start": 1761729728213, "stop": 1761729729262}, {"name": "轮询中（已等待7.5秒）", "status": "passed", "attachments": [{"name": "当前状态", "source": "ae2fe81b-74d5-4fd0-a101-5e010407905b-attachment.txt", "type": "text/plain"}, {"name": "超时倒计时", "source": "30ba1661-ac42-45ea-a95f-2c23a847f01d-attachment.txt", "type": "text/plain"}], "start": 1761729729262, "stop": 1761729729263}, {"name": "判断结果稳定性", "status": "passed", "attachments": [{"name": "唯一键信息", "source": "b9d2a0e6-b630-4890-a891-7bfe469d419f-attachment.txt", "type": "text/plain"}, {"name": "判断结果", "source": "0adcb9c4-df8a-497f-804e-548801a5517b-attachment.txt", "type": "text/plain"}], "start": 1761729729263, "stop": 1761729729264}, {"name": "数据发生变化", "status": "passed", "attachments": [{"name": "状态说明", "source": "18f1c53e-c279-442b-a7db-b3cc7d9a0502-attachment.txt", "type": "text/plain"}], "start": 1761729729264, "stop": 1761729729264}, {"name": "执行单次数据库查询", "status": "passed", "steps": [{"name": "执行数据库查询", "status": "passed", "attachments": [{"name": "执行SQL", "source": "0ff2a83b-9c0d-452e-877c-9f8cffbae14c-attachment.txt", "type": "text/plain"}, {"name": "SQL参数", "source": "efef41a8-76e5-4466-a422-f0e44eec03b5-attachment.txt", "type": "text/plain"}], "start": 1761729731330, "stop": 1761729732396}], "attachments": [{"name": "查询条件", "source": "15fba97d-e2c9-4e1f-88ac-17eccc02e9f2-attachment.txt", "type": "text/plain"}], "start": 1761729731329, "stop": 1761729732396}, {"name": "轮询中（已等待10.6秒）", "status": "passed", "attachments": [{"name": "当前状态", "source": "5a8b23be-0737-4e42-bd8e-7d26de23ed7f-attachment.txt", "type": "text/plain"}, {"name": "超时倒计时", "source": "e4190558-27d5-4860-ac60-b2b342fa53da-attachment.txt", "type": "text/plain"}], "start": 1761729732396, "stop": 1761729732398}, {"name": "判断结果稳定性", "status": "passed", "attachments": [{"name": "唯一键信息", "source": "f23fb64c-8753-4566-a1fd-967ed3dfea43-attachment.txt", "type": "text/plain"}, {"name": "判断结果", "source": "1be9d42f-6a70-44ae-8426-41a8e4967e90-attachment.txt", "type": "text/plain"}], "start": 1761729732398, "stop": 1761729732398}, {"name": "数据首次稳定", "status": "passed", "attachments": [{"name": "状态说明", "source": "8e287cb4-2414-4143-bdd9-2443893ecc26-attachment.txt", "type": "text/plain"}], "start": 1761729732398, "stop": 1761729732399}, {"name": "执行单次数据库查询", "status": "passed", "steps": [{"name": "执行数据库查询", "status": "passed", "attachments": [{"name": "执行SQL", "source": "cde95100-91e3-48a6-a883-4400bf692a67-attachment.txt", "type": "text/plain"}, {"name": "SQL参数", "source": "ccca3be5-7e03-496f-973e-e1c9f433e302-attachment.txt", "type": "text/plain"}], "start": 1761729734445, "stop": 1761729735516}], "attachments": [{"name": "查询条件", "source": "446863b4-73e6-4e45-b7bb-f7252a46b5cb-attachment.txt", "type": "text/plain"}], "start": 1761729734445, "stop": 1761729735516}, {"name": "轮询中（已等待13.7秒）", "status": "passed", "attachments": [{"name": "当前状态", "source": "36fea1dd-424b-48a0-8122-5c6d283495e5-attachment.txt", "type": "text/plain"}, {"name": "超时倒计时", "source": "54e8f5ff-023a-48f1-aa46-fb30b0366ca9-attachment.txt", "type": "text/plain"}], "start": 1761729735516, "stop": 1761729735516}, {"name": "判断结果稳定性", "status": "passed", "attachments": [{"name": "唯一键信息", "source": "19838af0-0d62-4276-9d37-a0a5dea715f7-attachment.txt", "type": "text/plain"}, {"name": "判断结果", "source": "075ce8ae-8478-4ef4-affe-9d3a0c1cabc6-attachment.txt", "type": "text/plain"}], "start": 1761729735516, "stop": 1761729735517}, {"name": "数据稳定达标", "status": "passed", "attachments": [{"name": "结果说明", "source": "2830d30e-48ea-4794-9cf2-88a34fc379a4-attachment.txt", "type": "text/plain"}], "start": 1761729735517, "stop": 1761729735517}, {"name": "数据库查询结果（最终稳定结果）", "status": "passed", "attachments": [{"name": "查询结果（共3条，显示前50条）", "source": "b59549f0-5dd6-478a-a7d2-93f4f1e3d818-attachment.json", "type": "application/json"}, {"name": "执行SQL", "source": "d119f3a0-5e2a-4e8f-89a1-0d59458996c5-attachment.txt", "type": "text/plain"}, {"name": "SQL参数", "source": "d06befba-1590-4aae-9272-73405405c8f0-attachment.txt", "type": "text/plain"}, {"name": "查询时间窗口", "source": "a2b96b19-7883-4fba-ab6b-789360d1763d-attachment.txt", "type": "text/plain"}], "start": 1761729735517, "stop": 1761729735518}], "start": 1761729721781, "stop": 1761729735518}], "start": 1761729721781, "stop": 1761729735518}, {"name": "2. 对订单状态进行校验", "status": "failed", "statusDetails": {"message": "AssertionError: 跟单失败，异常提示信息是：未开通下单状态，实际是：None\nassert None == '未开通下单状态'\n", "trace": "  File \"D:\\pycharm_test\\lingkuanMT5_1029\\test_cloudTrader\\test_cloudOrder_open_level.py\", line 1759, in test_dbquery_orderSend_addsalve\n    assert remark == \"未开通下单状态\", f\"跟单失败，异常提示信息是：未开通下单状态，实际是：{remark}\"\n"}, "start": 1761729735518, "stop": 1761729735518}], "attachments": [{"name": "log", "source": "97875fe1-aed6-40f5-97dc-2a4734234589-attachment.txt", "type": "text/plain"}], "start": 1761729721781, "stop": 1761729735519, "uuid": "c87fe820-b4ab-4248-97fd-ca4f449e0bbe", "historyId": "d3f3156bf96755d4c5c16ba22f8861a6", "testCaseId": "d3f3156bf96755d4c5c16ba22f8861a6", "fullName": "test_cloudTrader.test_cloudOrder_open_level.Testcloudstargy_status#test_dbquery_orderSend_addsalve", "labels": [{"name": "feature", "value": "云策略-策略账号交易下单-漏单场景"}, {"name": "story", "value": "场景4：交易下单-云策略复制下单-云策略-策略状态关闭"}, {"name": "parentSuite", "value": "test_cloudTrader"}, {"name": "suite", "value": "test_cloudOrder_open_level"}, {"name": "subSuite", "value": "TestMT5cloudTrader_openandlevel"}, {"name": "host", "value": "DESKTOP-4S9CU1E"}, {"name": "thread", "value": "80940-MainThread"}, {"name": "framework", "value": "pytest"}, {"name": "language", "value": "cpython3"}, {"name": "package", "value": "test_cloudTrader.test_cloudOrder_open_level"}]}