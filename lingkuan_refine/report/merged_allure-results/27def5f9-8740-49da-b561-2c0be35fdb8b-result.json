{"name": "数据库校验-跟单备注生效", "status": "broken", "statusDetails": {"message": "pymysql.err.InterfaceError: (0, '')", "trace": "self = <lingkuan_refine.test_cloudTrader.test_cloudfixed_annotations.TestCloudStrategyOrderRemark object at 0x000001FC6D2AD520>\nvar_manager = <lingkuan_refine.commons.variable_manager.VariableManager object at 0x000001FC6D833280>\ndb_transaction = <pymysql.connections.Connection object at 0x000001FC6D364BB0>\n\n    @allure.story(\"场景2：策略有固定注释，跟单有固定注释\")\n    @allure.title(\"数据库校验-跟单备注生效\")\n    def test_scenario2_verify_remark(self, var_manager, db_transaction):\n        with allure.step(\"查询订单备注信息\"):\n            cloudTrader_user_accounts_4 = var_manager.get_variable(\"cloudTrader_user_accounts_4\")\n            sql = \"\"\"\n                SELECT fod.comment\n                FROM follow_order_detail fod\n                INNER JOIN follow_order_instruct foi\n                    ON foi.order_no = fod.send_no COLLATE utf8mb4_0900_ai_ci\n                WHERE foi.operation_type = %s AND fod.account = %s\n            \"\"\"\n            params = ('0', cloudTrader_user_accounts_4)\n    \n>           db_data = self.query_database_with_time(\n                db_transaction=db_transaction,\n                sql=sql,\n                params=params,\n                time_field=\"foi.create_time\"\n            )\n\ntest_cloudTrader\\test_cloudfixed_annotations.py:319: \n_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _\ncommons\\api_base.py:662: in query_database_with_time\n    final_result = self._execute_query(\ncommons\\api_base.py:708: in _execute_query\n    return self.query_database_with_time(\ncommons\\api_base.py:480: in query_database_with_time\n    return self.query_database(\ncommons\\api_base.py:398: in query_database\n    cursor.execute(final_sql, params)\n..\\venv\\lib\\site-packages\\pymysql\\cursors.py:153: in execute\n    result = self._query(query)\n..\\venv\\lib\\site-packages\\pymysql\\cursors.py:322: in _query\n    conn.query(q)\n..\\venv\\lib\\site-packages\\pymysql\\connections.py:562: in query\n    self._execute_command(COMMAND.COM_QUERY, sql)\n_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _\n\nself = <pymysql.connections.Connection object at 0x000001FC6D364BB0>\ncommand = 3\nsql = b\"\\n                SELECT fod.comment \\n                FROM follow_order_detail fod\\n                INNER JOIN foll...       AND  foi.create_time BETWEEN NOW() - INTERVAL 1 MINUTE AND NOW() + INTERVAL 1 MINUTE  ORDER BY create_time DESC\"\n\n    def _execute_command(self, command, sql):\n        \"\"\"\n        :raise InterfaceError: If the connection is closed.\n        :raise ValueError: If no username was specified.\n        \"\"\"\n        if not self._sock:\n>           raise err.InterfaceError(0, \"\")\nE           pymysql.err.InterfaceError: (0, '')\n\n..\\venv\\lib\\site-packages\\pymysql\\connections.py:843: InterfaceError"}, "description": "\n### 测试说明\n包含三种云策略订单备注场景的完整测试流程：\n1. 场景1：策略有固定注释，跟单无固定注释 → 预期取策略备注\n2. 场景2：策略有固定注释，跟单有固定注释 → 预期取跟单备注\n3. 场景3：策略开启订单备注，跟单无固定注释 → 预期取开仓备注\n", "steps": [{"name": "查询订单备注信息", "status": "broken", "statusDetails": {"message": "pymysql.err.InterfaceError: (0, '')\n", "trace": "  File \"D:\\pycharm_test\\lingkuan_refine\\test_cloudTrader\\test_cloudfixed_annotations.py\", line 319, in test_scenario2_verify_remark\n    db_data = self.query_database_with_time(\n  File \"D:\\pycharm_test\\lingkuan_refine\\commons\\api_base.py\", line 662, in query_database_with_time\n    final_result = self._execute_query(\n  File \"D:\\pycharm_test\\lingkuan_refine\\commons\\api_base.py\", line 708, in _execute_query\n    return self.query_database_with_time(\n  File \"D:\\pycharm_test\\lingkuan_refine\\commons\\api_base.py\", line 480, in query_database_with_time\n    return self.query_database(\n  File \"D:\\pycharm_test\\lingkuan_refine\\commons\\api_base.py\", line 398, in query_database\n    cursor.execute(final_sql, params)\n  File \"D:\\pycharm_test\\venv\\lib\\site-packages\\pymysql\\cursors.py\", line 153, in execute\n    result = self._query(query)\n  File \"D:\\pycharm_test\\venv\\lib\\site-packages\\pymysql\\cursors.py\", line 322, in _query\n    conn.query(q)\n  File \"D:\\pycharm_test\\venv\\lib\\site-packages\\pymysql\\connections.py\", line 562, in query\n    self._execute_command(COMMAND.COM_QUERY, sql)\n  File \"D:\\pycharm_test\\venv\\lib\\site-packages\\pymysql\\connections.py\", line 843, in _execute_command\n    raise err.InterfaceError(0, \"\")\n"}, "steps": [{"name": "等待数据库记录稳定（超时: 30秒，稳定期: 3秒）", "status": "passed", "start": 1755512975385, "stop": 1755512975385}], "attachments": [{"name": "数据库异常", "source": "a4acbaa7-7910-46f8-a63a-8dac38edf51e-attachment.txt", "type": "text/plain"}, {"name": "数据库异常", "source": "0c8726bb-7e74-44b4-b6c5-056c944ab932-attachment.txt", "type": "text/plain"}, {"name": "数据库异常", "source": "31ad2829-1c65-4789-9a9d-d539d296d957-attachment.txt", "type": "text/plain"}, {"name": "数据库异常", "source": "88ebb688-c2aa-4aa9-bb79-14a7ddf7f5dd-attachment.txt", "type": "text/plain"}], "start": 1755512975385, "stop": 1755564916772}], "attachments": [{"name": "log", "source": "d77b4ed1-3c51-4e51-8fa8-e8a61a69fe01-attachment.txt", "type": "text/plain"}], "start": 1755512975385, "stop": 1755564916773, "uuid": "f69f64b0-75a9-41e1-b8f0-392f542cd581", "historyId": "290592848132d78b903e151dadb9291b", "testCaseId": "290592848132d78b903e151dadb9291b", "fullName": "test_cloudTrader.test_cloudfixed_annotations.TestCloudStrategyOrderRemark#test_scenario2_verify_remark", "labels": [{"name": "feature", "value": "云策略交易下单-跟随策略账号订单备注"}, {"name": "story", "value": "场景2：策略有固定注释，跟单有固定注释"}, {"name": "parentSuite", "value": "test_cloudTrader"}, {"name": "suite", "value": "test_cloudfixed_annotations"}, {"name": "subSuite", "value": "TestCloudStrategyOrderRemark"}, {"name": "host", "value": "DESKTOP-4S9CU1E"}, {"name": "thread", "value": "20452-MainThread"}, {"name": "framework", "value": "pytest"}, {"name": "language", "value": "cpython3"}, {"name": "package", "value": "test_cloudTrader.test_cloudfixed_annotations"}]}